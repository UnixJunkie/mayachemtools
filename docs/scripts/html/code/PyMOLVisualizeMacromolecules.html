<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeMacromolecules.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeMacromolecules.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2022 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script.&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; MayaChemTools v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">): Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetMayaChemToolsVersion</span><span class="p">(),</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateMacromolecularVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateMacromolecularVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate macromolecular visualization.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96     
   97     <span class="c1"># Load reffile for alignment..</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
   99         <span class="n">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup view for each input file...</span>
  102     <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="bp">None</span>
  104     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  105         <span class="c1"># Setup PyMOL object names...</span>
  106         <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  107 
  108         <span class="c1"># Setup complex view...</span>
  109         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">)</span>
  110         
  111         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  112         <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  113         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  114             <span class="k">if</span> <span class="n">FirstComplex</span> <span class="ow">and</span> <span class="n">FirstChain</span><span class="p">:</span>
  115                 <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  116                 
  117             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  118             
  119             <span class="c1"># Setup ligand views...</span>
  120             <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  121             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  122                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  123                 
  124                 <span class="c1"># Set up ligand level group...</span>
  125                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  126                 <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  127                     <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  128                     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130 
  131             <span class="c1"># Setup docked poses views...</span>
  132             <span class="k">if</span>  <span class="n">GetChainAloneDockedPosesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  133                 <span class="n">WriteChainDockedPosesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  134             
  135             <span class="c1"># Setup Chain level group...</span>
  136             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  137             <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  138                 <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  139                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  140             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  141 
  142         <span class="c1"># Set up complex level group...</span>
  143         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  144         <span class="k">if</span> <span class="n">FirstComplex</span><span class="p">:</span>
  145             <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">False</span>
  146             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  147         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  148         
  149         <span class="c1"># Delete empty PyMOL objects...</span>
  150         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  151         
  152     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  153         <span class="n">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  154 
  155     <span class="k">if</span> <span class="n">FirstComplexFirstChainName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  156         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;</span><span class="si">%s</span><span class="s2">&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">FirstComplexFirstChainName</span><span class="p">)</span>
  157     <span class="k">else</span><span class="p">:</span>
  158         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  159     
  160     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  161 
  162     <span class="c1"># Generate PSE file as needed...</span>
  163     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  164         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  165 
  166 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  167     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view.&quot;&quot;&quot;</span>
  168 
  169     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  170     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  171 
  172 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  173     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters.&quot;&quot;&quot;</span>
  174 
  175     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  176     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  177     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  178     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  179     
  180     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  181     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  182     
  183 <span class="k">def</span> <span class="nf">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  184     <span class="sd">&quot;&quot;&quot;Setup object for alignment reference.&quot;&quot;&quot;</span>
  185 
  186     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  187     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  188     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  189     
  190     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  191     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefName</span><span class="p">))</span>
  192     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  193     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  194     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  195     
  196     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for align reference...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  197     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  198     
  199 <span class="k">def</span> <span class="nf">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  200     <span class="sd">&quot;&quot;&quot;Setup alignment of complex to reference.&quot;&quot;&quot;</span>
  201 
  202     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  203     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  204     
  205     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  206     
  207     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstChain$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  208         <span class="n">RefFirstChainID</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  209         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">,</span> <span class="n">RefFirstChainID</span><span class="p">)</span>
  210         
  211         <span class="n">ComplexFirstChainID</span> <span class="o">=</span> <span class="n">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  212         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ComplexFirstChainID</span><span class="p">)</span>
  213     <span class="k">else</span><span class="p">:</span>
  214         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="n">RefName</span>
  215         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="n">ComplexName</span>
  216 
  217     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForAlignment</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">],</span> <span class="n">RefAlignSelection</span><span class="p">,</span> <span class="n">ComplexAlignSelection</span><span class="p">)</span>
  218     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Aligning </span><span class="si">%s</span><span class="s2"> against reference </span><span class="si">%s</span><span class="s2"> ...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexAlignSelection</span><span class="p">,</span> <span class="n">RefAlignSelection</span><span class="p">))</span>
  219     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  220     
  221 <span class="k">def</span> <span class="nf">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  222     <span class="sd">&quot;&quot;&quot;Delete alignment reference object.&quot;&quot;&quot;</span>
  223     
  224     <span class="n">RefName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  225     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Deleting alignment reference object </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  226     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  227 
  228 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">):</span>
  229     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex.&quot;&quot;&quot;</span>
  230 
  231     <span class="c1"># Setup complex...</span>
  232     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  233     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  234     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  235     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  236 
  237     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  238         <span class="c1"># No need to align complex on to itself...</span>
  239         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstComplex</span><span class="p">):</span>
  240             <span class="n">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  241     
  242     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  243         <span class="c1"># Setup hydrophobic surface...</span>
  244         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  245         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  246     
  247     <span class="c1"># Setup complex group...</span>
  248     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  249 
  250 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  251     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  252     
  253     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  254     
  255     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  256     
  257     <span class="c1"># Setup chain complex group view...</span>
  258     <span class="n">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  259 
  260     <span class="c1"># Setup chain view...</span>
  261     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  262     
  263     <span class="c1"># Setup chain solvent view...</span>
  264     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  265     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  266 
  267     <span class="c1"># Setup chain inorganic view...</span>
  268     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  269     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  270 
  271 <span class="k">def</span> <span class="nf">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  272     <span class="sd">&quot;&quot;&quot;Write chain complex views.&quot;&quot;&quot;</span>
  273     
  274     <span class="c1"># Setup chain complex...</span>
  275     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  276     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  277     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  278 
  279     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  280         <span class="c1"># Setup hydrophobic surface...</span>
  281         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  282         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  283     
  284     <span class="c1"># Setup chain complex group...</span>
  285     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  286     
  287 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  288     <span class="sd">&quot;&quot;&quot;Write individual chain views.&quot;&quot;&quot;</span>
  289 
  290     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  291     
  292     <span class="c1"># Setup chain view...</span>
  293     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  294     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  295     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  296 
  297     <span class="n">WriteChainAloneChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  298     <span class="n">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  299         
  300     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  301         <span class="c1"># Setup a generic color surface...</span>
  302         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">])</span>
  303         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  304         
  305         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  306             <span class="c1"># Setup surface colored by hydrophobicity...</span>
  307             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  308             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  309             
  310             <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  311             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  312             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  313         
  314         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  315             <span class="c1"># Setup electrostatics surface...</span>
  316             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">ChainName</span>
  317             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span>
  318             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span>
  319             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">)</span>
  320 
  321         <span class="c1"># Setup surface group...</span>
  322         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  323         
  324         <span class="c1"># Setup disulfide group...</span>
  325         <span class="n">WriteChainAloneDisulfideBondsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  326         
  327         <span class="c1"># Setup salt bridges group...</span>
  328         <span class="n">WriteChainAloneSaltBridgesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  329         
  330     <span class="c1"># Setup chain group...</span>
  331     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  332     
  333 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  334     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  335     
  336     <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  337         <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  338         <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  339         
  340         <span class="c1"># Setup main object...</span>
  341         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  342         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  343         
  344         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  345             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  346             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  347             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  348         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  349             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for pocket around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  350             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  351             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  352             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">GroupTypeObjectName</span><span class="p">))</span>
  353         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  354             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for solvent in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  355             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  356             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  357         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  358             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for inorganic in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  359             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  360             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  361         
  362         <span class="c1"># Set up polar contacts...</span>
  363         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|PocketSolvent|PocketInorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  364             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  365             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span>
  366             
  367             <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  368             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  369                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span>
  370             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  371                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span>
  372 
  373             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  374             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  375             
  376             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  377             
  378         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  379             <span class="c1"># Setup hydrophobic contacts...</span>
  380             <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  381             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span>
  382             <span class="n">HydrophobicContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
  383             
  384             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  385             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  386             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">HydrophobicContactsName</span><span class="p">))</span>
  387 
  388             <span class="c1"># Setup pocket residues...</span>
  389             <span class="n">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  390             <span class="n">WritePocketSurfacesTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  391         
  392         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  393             <span class="c1"># Setup ball and stick view...</span>
  394             <span class="n">BallAndStickNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  395             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickNameID</span><span class="p">]</span>
  396             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  397             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  398             
  399         <span class="c1"># Setup group...</span>
  400         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  401         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  402         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  403         <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  404 
  405         <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  406         <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span>
  407         <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Ligand|Pocket)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  408             <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  409             <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  410         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  411 
  412 <span class="k">def</span> <span class="nf">WriteChainDockedPosesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  413     <span class="sd">&quot;&quot;&quot;Write out PML for viewing docked poses for SD files in a chain.&quot;&quot;&quot;</span>
  414 
  415     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneDockedPosesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  416         <span class="k">return</span>
  417     
  418     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  419     <span class="k">for</span> <span class="n">SDFileIndex</span><span class="p">,</span> <span class="n">SDFile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFiles&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
  420         <span class="n">WriteChainDockedPosesViewForSDFile</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SDFileIndex</span><span class="p">)</span>
  421 
  422     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  423     
  424 <span class="k">def</span> <span class="nf">WriteChainDockedPosesViewForSDFile</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PDBFileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SDFileIndex</span><span class="p">):</span>
  425     <span class="sd">&quot;&quot;&quot;Write out PML for viewing docked poses for a SD file in a chain.&quot;&quot;&quot;</span>
  426 
  427     <span class="n">DockedPosesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesInfo&quot;</span><span class="p">]</span>
  428     
  429     <span class="n">LigandID</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;LigandID&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span>
  430     <span class="n">UseSDFileAsLigandID</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;UseSDFileAsLigandID&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span>
  431     <span class="n">SDFile</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFiles&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">][</span><span class="n">SDFileIndex</span><span class="p">]</span>
  432     <span class="n">SDFileID</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesIDs&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">][</span><span class="n">SDFileIndex</span><span class="p">]</span>
  433 
  434     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for docked poses in SD file ID </span><span class="si">%s</span><span class="s2"> for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SDFileID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  435     
  436     <span class="c1"># Setup poses view...</span>
  437     <span class="n">PosesName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;Poses&quot;</span><span class="p">]</span>
  438     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandsSDFileView</span><span class="p">(</span><span class="n">PosesName</span><span class="p">,</span> <span class="n">SDFile</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  439     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  440     
  441     <span class="c1"># Setup pocket view...</span>
  442     <span class="n">PocketName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;Pocket&quot;</span><span class="p">]</span>
  443     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  444     <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PosesName</span> <span class="k">if</span> <span class="n">UseSDFileAsLigandID</span> <span class="k">else</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  445     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">PocketName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  446     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  447     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">PocketName</span><span class="p">))</span>
  448     
  449     <span class="c1"># Setp polar contacts view...</span>
  450     <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;PolarContacts&quot;</span><span class="p">]</span>
  451     <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  452     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">PosesName</span><span class="p">,</span> <span class="n">PocketName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  453     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  454     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  455     
  456     <span class="c1"># Hydrophobic contacts view...</span>
  457     <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;HydrophobicContacts&quot;</span><span class="p">]</span>
  458     <span class="n">HydrophobicContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
  459     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">,</span> <span class="n">PosesName</span><span class="p">,</span> <span class="n">PocketName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  460     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  461     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">HydrophobicContactsName</span><span class="p">))</span>
  462     
  463     <span class="c1"># Setup docked poses group for a SD file...</span>
  464     <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span> <span class="k">if</span> <span class="n">SDFileIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;close&quot;</span>
  465     <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">SDFileIndex</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">False</span>
  466     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupName&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  467     
  468 <span class="k">def</span> <span class="nf">WritePocketSurfacesTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  469     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surfaces for a ligand pocket.&quot;&quot;&quot;</span>
  470 
  471     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  472         <span class="k">return</span>
  473     
  474     <span class="n">PocketObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PocketObjectID</span><span class="p">]</span>
  475     
  476     <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  477     <span class="n">SurfacesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  478 
  479     <span class="c1"># Cavity modes: 1 or 2.  1: Cavity surfaces; 2: Culled cavity surfaces...</span>
  480     <span class="n">CavityMode</span> <span class="o">=</span> <span class="mi">2</span>
  481     
  482     <span class="c1"># Setup surfaces subgroup and its members...</span>
  483     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="s2">&quot;Cavity&quot;</span><span class="p">]:</span>
  484         <span class="n">ProcessingCavity</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Cavity$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  485         
  486         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  487         <span class="n">SurfacesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  488         <span class="n">SurfacesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  489 
  490         <span class="c1"># Turn off lines display for cavity surfaces...</span>
  491         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">ProcessingCavity</span> <span class="k">else</span> <span class="s2">&quot;lines&quot;</span>
  492 
  493         <span class="c1"># Setup a generic color surface...</span>
  494         <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  495         <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span>
  496         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">],</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  497         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  498         
  499         <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  500             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">))</span>
  501         
  502         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">SurfaceName</span><span class="p">))</span>
  503         
  504         <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  505             <span class="c1"># Setup a surface colored by hydrphobicity...</span>
  506             <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  507             <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  508             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  509             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  510             
  511             <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  512                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  513             
  514             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  515             
  516             <span class="c1"># Setup a surface colored by hydrphobicity and charge...</span>
  517             <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  518             <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  519             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  520             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  521             
  522             <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  523                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">HydrophobicChargeSurfaceName</span><span class="p">))</span>
  524             
  525             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicChargeSurfaceName</span><span class="p">))</span>
  526             
  527             <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  528                 <span class="c1"># Set up a electrostatics surface...</span>
  529                 <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  530                 <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  531                 <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span>
  532                 <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span>
  533                 <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">SubGroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">,</span> <span class="n">SurfaceCavityMode</span> <span class="o">=</span> <span class="n">CavityMode</span><span class="p">)</span>
  534                 
  535             <span class="c1"># Setup surfaces sub group...</span>
  536             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  537         
  538     <span class="c1"># Setup surface group...</span>
  539     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  540     
  541     
  542 <span class="k">def</span> <span class="nf">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  543     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a ligand pocket.&quot;&quot;&quot;</span>
  544     
  545     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  546         <span class="k">return</span>
  547 
  548     <span class="n">PocketObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PocketObjectID</span><span class="p">]</span>
  549     
  550     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  551     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  552     
  553     <span class="c1"># Setup residue types objects...</span>
  554     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  555         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  556         
  557         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  558         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  559     
  560         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  561         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  562 
  563         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  564         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  565 
  566         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  567         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  568 
  569         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  570         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  571         
  572         <span class="c1"># Setup residue type sub groups...</span>
  573         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  574     
  575     <span class="c1"># Setup residue types group...</span>
  576     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  577 
  578 <span class="k">def</span> <span class="nf">WriteChainAloneChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  579     <span class="sd">&quot;&quot;&quot;Write out PML for viewing selections for a chain.&quot;&quot;&quot;</span>
  580 
  581     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  582         <span class="k">return</span>
  583     
  584     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  585     <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  586     
  587     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])):</span>
  588         <span class="n">SelectionName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  589         <span class="n">Selection</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Selections&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  590         
  591         <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  592         
  593         <span class="c1"># Setup a selection object...</span>
  594         <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  595         <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">]</span>
  596         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and (</span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)</span>
  597         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  598         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  599         
  600         <span class="k">if</span> <span class="n">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  601             <span class="c1"># Display style for selection objects in surfaces...</span>
  602             <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span>
  603             
  604             <span class="c1"># Setup a generic color surface...</span>
  605             <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">)</span>
  606             <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span>
  607             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">],</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  608             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  609             
  610             <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  611                 <span class="c1"># Setup a surface colored by hydrphobicity...</span>
  612                 <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceHydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  613                 <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  614                 <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  615                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  616                 
  617                 <span class="c1"># Setup a surface colored by hydrphobicity and charge...</span>
  618                 <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceHydrophobicityCharge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  619                 <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  620                 <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  621                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  622 
  623             <span class="c1"># Setup group for surfaces...</span>
  624             <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  625             <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  626             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  627 
  628         <span class="c1"># Setup groups for named selections...</span>
  629         <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  630         <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  631         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  632 
  633     <span class="c1"># Setup a group for selections...</span>
  634     <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  635     <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  636     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  637     
  638 <span class="k">def</span> <span class="nf">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  639     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a chain.&quot;&quot;&quot;</span>
  640 
  641     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  642         <span class="k">return</span>
  643     
  644     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  645     
  646     <span class="c1"># Setup residue types objects...</span>
  647     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  648     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  649         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  650 
  651         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  652         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  653 
  654         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  655         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  656 
  657         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  658         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  659 
  660         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  661         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  662 
  663         <span class="c1"># Setup sub groups for residue types..</span>
  664         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  665         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  666 
  667         <span class="c1"># Setup residue type sub groups...</span>
  668         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  669         
  670     <span class="c1"># Setup residue types group...</span>
  671     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  672 
  673 <span class="k">def</span> <span class="nf">WriteChainAloneDisulfideBondsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  674     <span class="sd">&quot;&quot;&quot;Write out PML for viewing disulfide bonds for a chain.&quot;&quot;&quot;</span>
  675 
  676     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneDisulfideBondsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  677         <span class="k">return</span>
  678 
  679     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  680     <span class="n">Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsResidues&quot;</span><span class="p">]</span>
  681     
  682     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForDisulfideBondsView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="s2">&quot;sticks&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  683     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  684     
  685     <span class="c1"># Setup disulfide bonds group...</span>
  686     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  687 
  688 <span class="k">def</span> <span class="nf">WriteChainAloneSaltBridgesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  689     <span class="sd">&quot;&quot;&quot;Write out PML for viewing salt bridges for a chain.&quot;&quot;&quot;</span>
  690 
  691     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneSaltBridgesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  692         <span class="k">return</span>
  693 
  694     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  695 
  696     <span class="c1"># Seup salt bridges resiudes group...</span>
  697     <span class="n">PositivelyChargedResiduesName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesPositivelyCharged&quot;</span><span class="p">]</span>
  698     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSaltBridgesResiduesView</span><span class="p">(</span><span class="n">PositivelyChargedResiduesName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainResiduesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Positively_Charged&quot;</span><span class="p">],</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  699     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  700     
  701     <span class="n">NegativelyChargedResiduesName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesNegativelyCharged&quot;</span><span class="p">]</span>
  702     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSaltBridgesResiduesView</span><span class="p">(</span><span class="n">NegativelyChargedResiduesName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainResiduesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">],</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  703     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  704     
  705     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  706 
  707     <span class="c1"># Setup salt bridges contacts...</span>
  708     <span class="n">ContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainContactsColor&quot;</span><span class="p">]</span>
  709     <span class="n">ContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesContacts&quot;</span><span class="p">]</span>
  710     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">ContactsName</span><span class="p">,</span> <span class="n">PositivelyChargedResiduesName</span><span class="p">,</span> <span class="n">NegativelyChargedResiduesName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">ContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainCutoff&quot;</span><span class="p">])</span>
  711     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  712     
  713     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ContactsColor</span><span class="p">,</span> <span class="n">ContactsName</span><span class="p">))</span>
  714     
  715     <span class="c1"># Setup salt bridges group...</span>
  716     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  717 
  718 <span class="k">def</span> <span class="nf">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">):</span>
  719     <span class="sd">&quot;&quot;&quot;Write residue types residues and surface view.&quot;&quot;&quot;</span>
  720 
  721     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNames</span><span class="p">)</span>
  722     <span class="k">if</span> <span class="n">NegateResidueNames</span><span class="p">:</span>
  723         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (not resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  724     <span class="k">else</span><span class="p">:</span>
  725         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  726 
  727     <span class="c1"># Setup residues...</span>
  728     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  729     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  730 
  731     <span class="c1"># Setup surface...</span>
  732     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">])</span>
  733     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  734     
  735 <span class="k">def</span> <span class="nf">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">SurfaceCavityMode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
  736     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surface electrostatics.&quot;&quot;&quot;</span>
  737 
  738     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
  739         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">,</span> <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  740     <span class="k">else</span><span class="p">:</span>
  741         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  742         <span class="n">VolumeName</span> <span class="o">=</span> <span class="bp">None</span>
  743 
  744     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  745 
  746     <span class="c1"># Setup chain...</span>
  747     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">))</span>
  748 
  749     <span class="c1"># Setup vacuum electrostatics surface along with associated objects...</span>
  750     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.protein_vacuum_esp(&quot;</span><span class="si">%s</span><span class="s2">&quot;, mode=2, quiet=0, _self=cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  751     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_chg&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  752     
  753     <span class="k">if</span> <span class="n">DisplayAs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  754         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  755 
  756     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Cavity$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  757         <span class="k">if</span> <span class="n">SurfaceCavityMode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  758             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceCavityMode</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  759         
  760     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
  761     
  762     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_map&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  763     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  764     
  765     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_pot&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">))</span>
  766     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">LegendName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  767 
  768     <span class="k">if</span> <span class="n">VolumeName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  769         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="s2">&quot;esp&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
  770         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  771     
  772     <span class="c1"># Delete name and take it out from the group membership. It is</span>
  773     <span class="c1"># is already part of ContactPotential object.</span>
  774     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  775     <span class="n">ElectrostaticsGroupMembers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  776     
  777     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  778     
  779     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  780     
  781     <span class="c1"># Setup group...</span>
  782     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  783 
  784 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  785     <span class="sd">&quot;&quot;&quot;Generate and write PML for group.&quot;&quot;&quot;</span>
  786     
  787     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  788     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  789     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  790 
  791 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  792     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file.&quot;&quot;&quot;</span>
  793 
  794     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  795     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  796     
  797     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  798     
  799     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  800     
  801     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  802         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  803     
  804     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  805         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  806         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  807 
  808 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  809     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects.&quot;&quot;&quot;</span>
  810     
  811     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  812         <span class="k">return</span>
  813     
  814     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  815     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  816         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  817         
  818         <span class="c1"># Delete any chain level objects...</span>
  819         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  820         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  821 
  822         <span class="c1"># Delete chain selection objects...</span>
  823         <span class="n">DeleteEmptyChainSelectionsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  824         
  825         <span class="c1"># Delete residue type objects...</span>
  826         <span class="n">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  827         
  828         <span class="c1"># Delete disulfide bonds objects...</span>
  829         <span class="n">DeleteEmptyChainDisulfideBondsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  830         
  831         <span class="c1"># Delete salt bridges objects...</span>
  832         <span class="n">DeleteEmptyChainSaltBridgesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  833         
  834         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  835             <span class="c1"># Delete ligand level objects...</span>
  836             <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  837                 <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  838                 <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  839 
  840                 <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  841                 <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  842                 
  843                 <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  844                 
  845                 <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  846                     <span class="n">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  847 
  848 <span class="k">def</span> <span class="nf">DeleteEmptyChainSelectionsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  849     <span class="sd">&quot;&quot;&quot;Delete empty chain selection objects &quot;&quot;&quot;</span>
  850 
  851     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  852         <span class="k">return</span>
  853     
  854     <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  855 
  856     <span class="k">for</span> <span class="n">SelectionName</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">]:</span>
  857         <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  858 
  859         <span class="c1"># Delete surface objects and surface group...</span>
  860         <span class="k">if</span> <span class="n">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  861             <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  862             <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  863             <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]),</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">])</span>
  864         
  865         <span class="c1"># Delete Selection object and selection name group...</span>
  866         <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  867         <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  868         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">])</span>
  869 
  870 <span class="k">def</span> <span class="nf">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  871     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects.&quot;&quot;&quot;</span>
  872     
  873     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  874         <span class="k">return</span>
  875     
  876     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  877     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  878         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  879         
  880         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  881         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span>
  882         
  883         <span class="n">GroupObjectNamesList</span> <span class="o">=</span> <span class="p">[]</span>
  884         
  885         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  886         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  887         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesObjectName</span><span class="p">)</span>
  888         
  889         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  890         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  891         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSurfaceObjectName</span><span class="p">)</span>
  892         
  893         <span class="n">GroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupObjectNamesList</span><span class="p">)</span>
  894         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupObjectNames</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  895 
  896 <span class="k">def</span> <span class="nf">DeleteEmptyChainDisulfideBondsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  897     <span class="sd">&quot;&quot;&quot;Delete empty chain disulfide bonds objects.&quot;&quot;&quot;</span>
  898 
  899     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneDisulfideBondsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  900         <span class="k">return</span>
  901     
  902     <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsResidues&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroup&quot;</span><span class="p">])</span>
  903     
  904 <span class="k">def</span> <span class="nf">DeleteEmptyChainSaltBridgesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  905     <span class="sd">&quot;&quot;&quot;Delete empty chain salt bridges objects.&quot;&quot;&quot;</span>
  906     
  907     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneSaltBridgesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  908         <span class="k">return</span>
  909     
  910     <span class="n">Names</span> <span class="o">=</span> <span class="p">[]</span>
  911     <span class="n">Names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesPositivelyCharged&quot;</span><span class="p">])</span>
  912     <span class="n">Names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesNegativelyCharged&quot;</span><span class="p">])</span>
  913     
  914     <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Names</span><span class="p">),</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroup&quot;</span><span class="p">])</span>
  915     
  916 <span class="k">def</span> <span class="nf">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  917     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects. &quot;&quot;&quot;</span>
  918     
  919     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  920         <span class="k">return</span>
  921     
  922     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  923     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  924     
  925     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  926         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  927         
  928         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  929         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  930 
  931         <span class="n">SubGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span>
  932         <span class="n">SubGroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">])</span>
  933         
  934         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SubGroupObjectNames</span><span class="p">,</span> <span class="n">SubGroupName</span><span class="p">)</span>
  935 
  936 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  937     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects.&quot;&quot;&quot;</span>
  938     
  939     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  940         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  941     <span class="k">else</span><span class="p">:</span>
  942         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  943     
  944     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  945     
  946 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
  947     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  948 <span class="sd">    chains and ligands present in input file.</span>
  949 <span class="sd">    &quot;&quot;&quot;</span>
  950 
  951     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  952     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  953     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  954     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  955 
  956     <span class="c1"># Setup groups and objects for complex...</span>
  957     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  958     
  959     <span class="c1"># Setup groups and objects for chain...</span>
  960     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  961     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  962         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  963         
  964         <span class="c1"># Setup groups and objects for ligand...</span>
  965         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  966             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  967 
  968         <span class="c1"># Setup group and objects for docked poses...</span>
  969         <span class="k">if</span>  <span class="n">GetChainAloneDockedPosesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  970             <span class="n">SetupPyMOLObjectNamesForDockedPoses</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  971 
  972     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  973 
  974 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  975     <span class="sd">&quot;&quot;&quot;Setup groups and objects for complex.&quot;&quot;&quot;</span>
  976     
  977     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  978     
  979     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  980     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  981     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  982 
  983     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  984     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  985     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  986     
  987     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  988     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  989         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  990 
  991     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  992     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  993     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  994         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">])</span>
  995     
  996 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  997     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  998     
  999     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
 1000     
 1001     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1002     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1003     
 1004     <span class="c1"># Set up chain group and chain objects...</span>
 1005     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1006     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
 1007     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1008     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1009     
 1010     <span class="c1"># Setup chain complex group and objects...</span>
 1011     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1012     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
 1013     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1014 
 1015     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1016     
 1017     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1018     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1019     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1020     
 1021     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
 1022         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1023         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1024         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1025 
 1026     <span class="c1"># Setup up a group for individual chains...</span>
 1027     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1028     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
 1029     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1030         
 1031     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1032         
 1033     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1034     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1035     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1036 
 1037     <span class="k">if</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1038         <span class="c1"># Setup selections group and its subgroups..</span>
 1039         <span class="n">SelectionsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selections&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1040         
 1041         <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
 1042         <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
 1043         
 1044         <span class="c1"># Add selections group to chain alone group...</span>
 1045         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsGroupName</span>
 1046         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">)</span>
 1047         
 1048         <span class="c1"># Initialize selections group members...</span>
 1049         <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
 1050         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1051 
 1052         <span class="c1"># Setup selections name sub group and its members...</span>
 1053         <span class="k">for</span> <span class="n">SelectionName</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">]:</span>
 1054             <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
 1055             
 1056             <span class="n">SelectionsNameGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">,</span> <span class="n">SelectionName</span><span class="p">)</span>
 1057             <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1058 
 1059             <span class="c1"># Add selections name sub group to selections group...</span>
 1060             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsNameGroupName</span>
 1061             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1062             
 1063             <span class="c1"># Initialize selections names sub group members...</span>
 1064             <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1065             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1066 
 1067             <span class="c1"># Add selection member to selections name group...</span>
 1068             <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1069             <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1070             
 1071             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1072             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1073             
 1074             <span class="k">if</span> <span class="n">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1075                 <span class="c1"># Setup a surface sub group and add it to selections name group...</span>
 1076                 
 1077                 <span class="n">SelectionsNameSurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1078                 <span class="n">SelectionsNameSurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1079 
 1080                 <span class="c1"># Add selection surface group to selection name group...</span>
 1081                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsNameSurfaceGroupName</span>
 1082                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">)</span>
 1083 
 1084                 <span class="c1"># Initialize surface names sub group members...</span>
 1085                 <span class="n">SelectionsNameSurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1086                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1087                 
 1088                 <span class="c1"># Setup a generic color surface...</span>
 1089                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">)</span>
 1090                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">)</span>
 1091                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1092                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1093                 
 1094                 <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1095                     <span class="c1"># Setup surfaces...</span>
 1096                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hydrophobicity&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobicity_Charge&quot;</span><span class="p">]:</span>
 1097                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1098                         
 1099                         <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1100                         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1101                         
 1102                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1103                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1104 
 1105     <span class="k">if</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1106         <span class="c1"># Setup residue type group and its subgroups...</span>
 1107         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1108         
 1109         <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
 1110         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
 1111 
 1112         <span class="c1"># Add residue group to chain alone group...</span>
 1113         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
 1114         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1115         
 1116         <span class="c1"># Initialize residue group members...</span>
 1117         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
 1118         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1119 
 1120         <span class="c1"># Setup residues sub groups and its members...</span>
 1121         <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
 1122             <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1123 
 1124             <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1125             <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1126 
 1127             <span class="c1"># Add sub group to residues group...</span>
 1128             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
 1129             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
 1130 
 1131             <span class="c1"># Initialize sub group members...</span>
 1132             <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1133             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1134             
 1135             <span class="c1"># Add sub group members to subgroup...</span>
 1136             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
 1137                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1138 
 1139                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1140                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1141                 
 1142                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1143                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1144 
 1145     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1146         <span class="c1"># Setup a surface group and add it to chain alone group...</span>
 1147         <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1148         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
 1149         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1150         
 1151         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1152 
 1153         <span class="c1"># Setup a generic color surface...</span>
 1154         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1155         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1156         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1157         
 1158         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1159             <span class="c1"># Setup hydrophobicity surface...</span>
 1160             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1161             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1162             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1163             
 1164             <span class="c1"># Setup hydrophobicity and charge surface...</span>
 1165             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1166             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1167             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1168     
 1169         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1170             <span class="c1"># Setup electrostatics group...</span>
 1171             <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1172             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1173             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1174             
 1175             <span class="c1"># Setup electrostatics group members...</span>
 1176             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1177             
 1178             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]:</span>
 1179                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1180                 
 1181                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1182                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneElectrostaticsSurface</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MemberID</span>
 1183                 
 1184                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1185                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1186 
 1187     <span class="k">if</span> <span class="n">GetChainAloneDisulfideBondsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1188         <span class="c1"># Setup disulfide bonds group and add it to chain alone group...</span>
 1189         <span class="n">DisulfideBondsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Disulfide_Bonds&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1190         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisulfideBondsGroupName</span>
 1191         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DisulfideBondsGroupName</span><span class="p">)</span>
 1192         
 1193         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1194 
 1195         <span class="c1"># Setup a residues object for disulfide bonds...</span>
 1196         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisulfideBondsGroupName</span><span class="p">)</span>
 1197         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsResidues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1198         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneDisulfideBondsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1199         
 1200     <span class="k">if</span> <span class="n">GetChainAloneSaltBridgesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1201         <span class="c1"># Setup salt bridges group and add it to chain alone group...</span>
 1202         <span class="n">SaltBridgesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Salt_Bridges&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1203         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SaltBridgesGroupName</span>
 1204         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SaltBridgesGroupName</span><span class="p">)</span>
 1205     
 1206         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1207 
 1208         <span class="c1"># Setup residues group and add it to salt bridges group...</span>
 1209         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SaltBridgesGroupName</span><span class="p">)</span>
 1210         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
 1211         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1212         
 1213         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1214 
 1215         <span class="c1"># Setup objects for residues group...</span>
 1216         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Positively_Charged&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1217         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesPositivelyCharged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1218         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1219         
 1220         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Negatively_Charged&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1221         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesNegativelyCharged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1222         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesResiduesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1223 
 1224         <span class="c1"># Add contacts object to salt bridges group...</span>
 1225         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SaltBridgesGroupName</span><span class="p">)</span>
 1226         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1227         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSaltBridgesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1228     
 1229     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
 1230     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
 1231         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
 1232         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1233         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1234 
 1235 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1236     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
 1237 
 1238     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1239     
 1240     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
 1241     
 1242     <span class="c1"># Setup a chain level ligand group...</span>
 1243     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
 1244     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
 1245     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
 1246     
 1247     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1248 
 1249     <span class="c1"># Set up groups and objects for a specific ligand group...</span>
 1250     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Inorganic&quot;</span><span class="p">]:</span>
 1251         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1252         <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1253                 
 1254         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1255         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1256         
 1257         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1258         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1259         
 1260         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1261         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1262         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span>
 1263         
 1264         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1265         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">)</span>
 1266         
 1267         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1268             <span class="c1"># Only need to add ball and stick...</span>
 1269             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1270             <span class="n">BallAndStickID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1271             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BallAndStickName</span>
 1272             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">)</span>
 1273         
 1274         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|Pocket_Solvent|Pocket_Inorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1275             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1276             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1277             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
 1278             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
 1279                 
 1280         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1281             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobic_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1282             <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1283             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicContactsName</span>
 1284             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">)</span>
 1285             
 1286             <span class="k">if</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1287                 <span class="c1"># Setup residue type group and add to pocket group...</span>
 1288                 <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1289                 <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1290                 <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
 1291 
 1292                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
 1293                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1294                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1295                 
 1296                 <span class="c1"># Setup residue group subgroup and its members...</span>
 1297                 <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
 1298                     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1299                     <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1300                     <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1301                     <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
 1302                     
 1303                     <span class="c1"># Add sub group to residues group...</span>
 1304                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
 1305                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
 1306                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1307                     
 1308                     <span class="c1"># Add sub group members to subgroup...</span>
 1309                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
 1310                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1311                         <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1312                         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1313                         
 1314                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1315                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1316 
 1317             <span class="k">if</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1318                 <span class="c1"># Setup a surfaces group and add it to pocket group...</span>
 1319                 <span class="n">SurfacesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surfaces&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1320                 <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1321                 <span class="n">SurfacesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
 1322 
 1323                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfacesGroupName</span>
 1324                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfacesGroupName</span><span class="p">)</span>
 1325                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1326 
 1327                 <span class="c1"># Setup surfaces subgroup and its members...</span>
 1328                 <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="s2">&quot;Cavity&quot;</span><span class="p">]:</span>
 1329                     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1330                     <span class="n">SurfacesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1331                     <span class="n">SurfacesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1332                     <span class="n">SurfacesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1333                     
 1334                     <span class="c1"># Add sub group to surfaces group...</span>
 1335                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfacesSubGroupName</span>
 1336                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1337                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1338                     
 1339                     <span class="c1"># Setup a generic color surface...</span>
 1340                     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1341                     <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1342                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceName</span>
 1343                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">)</span>
 1344                     
 1345                     <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1346                         <span class="c1"># Surface colored by hydrophobicity...</span>
 1347                         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1348                         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1349                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
 1350                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
 1351                         
 1352                         <span class="c1"># Surface colored by hydrophobicity and charge...</span>
 1353                         <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1354                         <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1355                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicChargeSurfaceName</span>
 1356                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">)</span>
 1357                 
 1358                     <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1359                         <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1360                         <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1361                         <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1362                         
 1363                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupName</span>
 1364                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">)</span>
 1365                         
 1366                         <span class="c1"># Setup electrostatics group members without the volume object...</span>
 1367                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1368                         
 1369                         <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">]:</span>
 1370                             <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1371                             
 1372                             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1373                             <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1374                             
 1375                             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1376                             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1377     
 1378 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForDockedPoses</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1379     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for docked poses in SD files for a chain.&quot;&quot;&quot;</span>
 1380 
 1381     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1382     
 1383     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneDockedPosesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1384         <span class="k">return</span>
 1385     
 1386     <span class="c1"># Setup group for docked poses...</span>
 1387     <span class="k">if</span> <span class="s2">&quot;DockedPosesGroup&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1388         <span class="c1"># Setup docked poses group at a chain level...</span>
 1389         <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
 1390         <span class="n">DockedPosesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Docked_Poses&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1391         
 1392         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DockedPosesGroupName</span>
 1393         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DockedPosesGroupName</span><span class="p">)</span>
 1394         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1395     
 1396     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1397     <span class="k">for</span> <span class="n">SDFileIndex</span><span class="p">,</span> <span class="n">SDFile</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFiles&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1398         <span class="n">SetupPyMOLObjectNamesForDockedPosesSDFile</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SDFileIndex</span><span class="p">)</span>
 1399     
 1400 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForDockedPosesSDFile</span><span class="p">(</span><span class="n">PDBFileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SDFileIndex</span><span class="p">):</span>
 1401     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for docked poses in a SD file for a chain.&quot;&quot;&quot;</span>
 1402     
 1403     <span class="n">DockedPosesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesInfo&quot;</span><span class="p">]</span>
 1404     
 1405     <span class="n">SDFileID</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesIDs&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">][</span><span class="n">SDFileIndex</span><span class="p">]</span>
 1406     
 1407     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1408     
 1409     <span class="n">DockedPosesGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroup&quot;</span><span class="p">]</span>
 1410 
 1411     <span class="c1"># Setup a docked poses level SDFile group...</span>
 1412     <span class="n">DockedPosesSDFileGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DockedPosesGroupName</span><span class="p">,</span> <span class="n">SDFileID</span><span class="p">)</span>
 1413     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DockedPosesSDFileGroupName</span>
 1414     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DockedPosesSDFileGroupName</span><span class="p">)</span>
 1415 
 1416     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1417 
 1418     <span class="c1"># Setup objects for docked poses...</span>
 1419     <span class="n">PosesName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Poses&quot;</span> <span class="o">%</span> <span class="n">DockedPosesSDFileGroupName</span>
 1420     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;Poses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PosesName</span>
 1421     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PosesName</span><span class="p">)</span>
 1422 
 1423     <span class="n">PocketName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Pocket&quot;</span> <span class="o">%</span> <span class="n">DockedPosesSDFileGroupName</span>
 1424     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;Pocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketName</span>
 1425     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PocketName</span><span class="p">)</span>
 1426     
 1427     <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="n">DockedPosesSDFileGroupName</span>
 1428     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;PolarContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
 1429     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
 1430     
 1431     <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobic_Contacts&quot;</span> <span class="o">%</span> <span class="n">DockedPosesSDFileGroupName</span>
 1432     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;HydrophobicContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicContactsName</span>
 1433     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFile&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SDFileID</span><span class="p">][</span><span class="s2">&quot;DockedPosesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">)</span>
 1434     
 1435 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
 1436     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
 1437 
 1438     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1439     
 1440     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1441     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1442     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1443     
 1444     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
 1445         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1446         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1447         
 1448         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
 1449         
 1450         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1451         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
 1452         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
 1453     
 1454     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
 1455 
 1456 <span class="k">def</span> <span class="nf">RetrieveRefFileInfo</span><span class="p">():</span>
 1457     <span class="sd">&quot;&quot;&quot;Retrieve information for ref file.&quot;&quot;&quot;</span>
 1458 
 1459     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1460     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
 1461         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1462         <span class="k">return</span>
 1463 
 1464     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
 1465     
 1466     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">RefFile</span><span class="p">)</span>
 1467     <span class="n">RefFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1468     
 1469     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1470         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1471     <span class="k">else</span><span class="p">:</span>
 1472         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information for alignment reference file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
 1473         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefFileRoot</span><span class="p">)</span>
 1474 
 1475     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFile</span>
 1476     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileRoot</span>
 1477     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AlignRef_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RefFileRoot</span>
 1478     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandInfo</span>
 1479     
 1480     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1481 
 1482 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
 1483     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs for infiles.&quot;&quot;&quot;</span>
 1484     
 1485     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1486     
 1487     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1488         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing specified chain and ligand IDs for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
 1489         
 1490         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1491         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
 1492         <span class="n">ProcessResidueTypesAndSurfaceAndChainSelectionsOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1493         
 1494         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1495         
 1496         <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1497         
 1498 <span class="k">def</span> <span class="nf">ProcessResidueTypesAndSurfaceAndChainSelectionsOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1499     <span class="sd">&quot;&quot;&quot;Process residue types, surface, and chian selections options for chains and pockets.&quot;&quot;&quot;</span>
 1500 
 1501     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1502     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1503     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1504     
 1505     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1506     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1507     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1508     
 1509     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1510     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1511 
 1512     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1513     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1514     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1515     
 1516     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1517     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1518     
 1519     <span class="c1"># Load infile...</span>
 1520     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1521     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1522     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1523     
 1524     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1525         <span class="n">AminoAcidsPresent</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1526 
 1527         <span class="c1"># Process surfaces for chains...</span>
 1528         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1529             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1530         <span class="k">else</span><span class="p">:</span>
 1531             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1532         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1533 
 1534         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1535             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1536         <span class="k">else</span><span class="p">:</span>
 1537             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1538         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainElectrostatics</span>
 1539 
 1540         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1541         
 1542         <span class="c1"># Process disulfide bonds fo chains...</span>
 1543         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1544             <span class="n">DisulfideBondsChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1545         <span class="k">else</span><span class="p">:</span>
 1546             <span class="n">DisulfideBondsChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1547         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DisulfideBondsChain</span>
 1548 
 1549         <span class="c1"># Process salt bridges bonds fo chains...</span>
 1550         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1551             <span class="n">SaltBridgesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1552         <span class="k">else</span><span class="p">:</span>
 1553             <span class="n">SaltBridgesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1554         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SaltBridgesChain</span>
 1555 
 1556         <span class="c1"># Process residue types for chains...</span>
 1557         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1558             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1559         <span class="k">else</span><span class="p">:</span>
 1560             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1561         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesChain</span>
 1562 
 1563         <span class="c1"># Process chain selections...</span>
 1564         <span class="n">ChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
 1565         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelections</span>
 1566         
 1567         <span class="c1"># Process surfaces for chain selections...</span>
 1568         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1569             <span class="n">SurfaceChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1570         <span class="k">else</span><span class="p">:</span>
 1571             <span class="n">SurfaceChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1572         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainSelections</span>
 1573         
 1574         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainSelections</span>
 1575         
 1576         <span class="c1"># Process residue types and surfaces for pockets...</span>
 1577         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1578         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1579         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1580         
 1581         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1582         
 1583         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1584             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1585                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1586             <span class="k">else</span><span class="p">:</span>
 1587                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1588             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurface</span>
 1589             
 1590             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1591                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1592             <span class="k">else</span><span class="p">:</span>
 1593                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1594             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurfaceElectrostatics</span>
 1595 
 1596             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurface</span>
 1597         
 1598             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1599                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1600             <span class="k">else</span><span class="p">:</span>
 1601                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1602             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketResidueTypes</span>
 1603     
 1604     <span class="c1"># Delete loaded object...</span>
 1605     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1606 
 1607 <span class="k">def</span> <span class="nf">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1608     <span class="sd">&quot;&quot;&quot;Get status of residue types for chain alone object.&quot;&quot;&quot;</span>
 1609 
 1610     <span class="n">Status</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1611     
 1612     <span class="k">return</span> <span class="n">Status</span>
 1613 
 1614 <span class="k">def</span> <span class="nf">GetChainAloneDisulfideBondsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1615     <span class="sd">&quot;&quot;&quot;Get status of disulfide bonds for chain alone object.&quot;&quot;&quot;</span>
 1616     
 1617     <span class="n">Status</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1618     
 1619     <span class="k">return</span> <span class="n">Status</span>
 1620 
 1621 <span class="k">def</span> <span class="nf">GetChainAloneSaltBridgesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1622     <span class="sd">&quot;&quot;&quot;Get status of salt bridges for chain alone object.&quot;&quot;&quot;</span>
 1623     
 1624     <span class="n">Status</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1625     
 1626     <span class="k">return</span> <span class="n">Status</span>
 1627 
 1628 <span class="k">def</span> <span class="nf">GetChainAloneDockedPosesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1629     <span class="sd">&quot;&quot;&quot;Get status of docked for chain alone object.&quot;&quot;&quot;</span>
 1630     
 1631     <span class="n">Status</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;DockedPoses&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1632     
 1633     <span class="k">return</span> <span class="n">Status</span>
 1634 
 1635 <span class="k">def</span> <span class="nf">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1636     <span class="sd">&quot;&quot;&quot;Get status of residue types for a pocket.&quot;&quot;&quot;</span>
 1637 
 1638     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1639 
 1640 <span class="k">def</span> <span class="nf">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1641     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1642 
 1643     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1644 
 1645 <span class="k">def</span> <span class="nf">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1646     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in a pocket.&quot;&quot;&quot;</span>
 1647 
 1648     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1649 
 1650 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1651     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1652 
 1653     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1654 
 1655 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1656     <span class="sd">&quot;&quot;&quot;Get status of electrostatics surfaces for chain alone object.&quot;&quot;&quot;</span>
 1657 
 1658     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1659 
 1660 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1661     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1662 
 1663     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1664 
 1665 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1666     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1667 
 1668     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1669 
 1670 <span class="k">def</span> <span class="nf">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1671     <span class="sd">&quot;&quot;&quot;Get status of selections present in chain alone object.&quot;&quot;&quot;</span>
 1672     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1673 
 1674 <span class="k">def</span> <span class="nf">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1675     <span class="sd">&quot;&quot;&quot;Get status of chain selections surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1676     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1677 
 1678 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1679     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1680     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1681 
 1682 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1683     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1684 
 1685     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1686     
 1687     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1688         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1689             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1690         <span class="k">else</span><span class="p">:</span>
 1691             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1692             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1693 
 1694 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1695     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1696     
 1697     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1698     
 1699     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1700     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1701         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1702     
 1703     <span class="k">return</span> <span class="n">FirstChainID</span>
 1704 
 1705 <span class="k">def</span> <span class="nf">ProcessDockedPoses</span><span class="p">():</span>
 1706     <span class="sd">&quot;&quot;&quot;Process docked poses.&quot;&quot;&quot;</span>
 1707 
 1708     <span class="n">DockedPosesInfo</span> <span class="o">=</span> <span class="n">ProcessDockedPosesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--dockedPoses&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPoses&quot;</span><span class="p">])</span>
 1709     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DockedPosesInfo</span>
 1710 
 1711     <span class="n">ProcessDockedPosesInfoForInfiles</span><span class="p">()</span>
 1712     
 1713 <span class="k">def</span> <span class="nf">ProcessDockedPosesInfoForInfiles</span><span class="p">():</span>
 1714     <span class="sd">&quot;&quot;&quot;Process docked poses info for infiles.&quot;&quot;&quot;</span>
 1715 
 1716     <span class="n">DockedPosesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesInfo&quot;</span><span class="p">]</span>
 1717     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1718         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1719         <span class="n">ProcessDockedPosesInfoForInfileAndChains</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">DockedPosesInfo</span><span class="p">)</span>
 1720 
 1721 <span class="k">def</span> <span class="nf">ProcessDockedPosesInfoForInfileAndChains</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">DockedPosesInfo</span><span class="p">):</span>
 1722     <span class="sd">&quot;&quot;&quot;Process docked poses info for a specific infile.&quot;&quot;&quot;</span>
 1723     
 1724     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPoses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1725     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1726     
 1727     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1728         <span class="n">DockedPoses</span> <span class="o">=</span> <span class="bp">False</span>
 1729         <span class="k">if</span> <span class="n">DockedPosesInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1730             <span class="k">if</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;PDBFileIndices&quot;</span><span class="p">]:</span>
 1731                 <span class="k">if</span> <span class="n">ChainID</span> <span class="o">==</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s1">&#39;ChainID&#39;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]:</span>
 1732                     <span class="n">DockedPoses</span> <span class="o">=</span> <span class="bp">True</span>
 1733         
 1734         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPoses&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DockedPoses</span>
 1735         
 1736         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFiles&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1737         <span class="k">if</span> <span class="n">DockedPoses</span><span class="p">:</span>
 1738             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPosesSDFiles&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s1">&#39;SDFiles&#39;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
 1739 
 1740 <span class="k">def</span> <span class="nf">ProcessDockedPosesOptionsInfo</span><span class="p">(</span><span class="n">DockedPosesOptionName</span><span class="p">,</span> <span class="n">DockedPosesOptionValue</span><span class="p">):</span>
 1741     <span class="sd">&quot;&quot;&quot;Process docked poses options info. &quot;&quot;&quot;</span>
 1742 
 1743     <span class="n">DockedPoses</span> <span class="o">=</span> <span class="n">DockedPosesOptionValue</span>
 1744     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^none$&quot;</span><span class="p">,</span> <span class="n">DockedPoses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1745         <span class="k">return</span> <span class="bp">None</span>
 1746 
 1747     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing docked poses...&quot;</span><span class="p">)</span>
 1748     
 1749     <span class="c1"># Initialize docked poses info...</span>
 1750     <span class="n">DockedPosesInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1751     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;PDBFileIndices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1752     
 1753     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;PDBFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1754     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;ChainID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1755     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;LigandID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1756     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;UseSDFileAsLigandID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1757     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1758     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1759     <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1760     
 1761     <span class="c1"># Parse docked poses values...</span>
 1762     <span class="n">DockedPosesWords</span> <span class="o">=</span> <span class="n">DockedPoses</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1763     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DockedPosesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1764         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited docked poses values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 4.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DockedPosesWords</span><span class="p">),</span> <span class="n">DockedPosesOptionName</span><span class="p">))</span>
 1765     
 1766     <span class="c1"># Validate and process specified values...</span>
 1767     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">DockedPosesWords</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
 1768         <span class="n">PDBFile</span> <span class="o">=</span> <span class="n">DockedPosesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1769         <span class="n">ChainID</span> <span class="o">=</span> <span class="n">DockedPosesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1770         <span class="n">LigandID</span> <span class="o">=</span> <span class="n">DockedPosesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1771         <span class="n">SDFiles</span> <span class="o">=</span> <span class="n">DockedPosesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1772         
 1773         <span class="n">SDFiles</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[ ]+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">SDFiles</span><span class="p">)</span>
 1774         <span class="n">SDFiles</span> <span class="o">=</span> <span class="n">SDFiles</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
 1775 
 1776         <span class="c1"># Process PDB file...</span>
 1777         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--dockedPoses&quot;</span><span class="p">,</span> <span class="n">PDBFile</span><span class="p">)</span>
 1778         
 1779         <span class="n">PDBFileIndex</span> <span class="o">=</span> <span class="bp">None</span>
 1780         <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1781             <span class="n">PDBInfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1782             <span class="k">if</span> <span class="n">PDBFile</span> <span class="o">==</span> <span class="n">PDBInfile</span><span class="p">:</span>
 1783                 <span class="n">PDBFileIndex</span> <span class="o">=</span> <span class="n">FileIndex</span>
 1784                 <span class="k">break</span>
 1785         <span class="k">if</span> <span class="n">PDBFileIndex</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1786             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The PDB file specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--dockedPoses</span><span class="se">\&quot;</span><span class="s2"> is not valid. It must be specified as an input file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBFile</span><span class="p">))</span>
 1787 
 1788         <span class="k">if</span> <span class="n">PDBFileIndex</span> <span class="ow">in</span> <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s1">&#39;PDBFileIndices&#39;</span><span class="p">]:</span>
 1789             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The PDB file specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--dockedPoses</span><span class="se">\&quot;</span><span class="s2"> is not valid. It is a duplicate and has already been specified.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBFile</span><span class="p">))</span>
 1790 
 1791         <span class="c1"># Process chain ID...</span>
 1792         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span>
 1793         <span class="k">if</span> <span class="n">ChainID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1794             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified for PDB file, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--dockedPoses</span><span class="se">\&quot;</span><span class="s2"> is not valid. It must be present in valid chain IDs corresponding to option </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> .&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">PDBFile</span><span class="p">))</span>
 1795 
 1796         <span class="c1"># Process ligand ID...</span>
 1797         <span class="n">UseSDFileAsLigandID</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^UseSDFile$&quot;</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1798         <span class="k">if</span> <span class="ow">not</span> <span class="n">UseSDFileAsLigandID</span><span class="p">:</span>
 1799             <span class="k">if</span> <span class="n">LigandID</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1800                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, specified for chain ID, </span><span class="si">%s</span><span class="s2">, and PDB file, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--dockedPoses</span><span class="se">\&quot;</span><span class="s2"> is not valid. It must be present in valid ligand IDs corresponding to option </span><span class="se">\&quot;</span><span class="s2">-l, --ligandIDs</span><span class="se">\&quot;</span><span class="s2"> .&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">PDBFile</span><span class="p">))</span>
 1801 
 1802         <span class="c1"># Process SD files...</span>
 1803         <span class="n">SDFilesRoots</span> <span class="o">=</span> <span class="p">[]</span>
 1804         <span class="n">SDFilesIDs</span> <span class="o">=</span> <span class="p">[]</span>
 1805         <span class="k">for</span> <span class="n">SDFile</span> <span class="ow">in</span> <span class="n">SDFiles</span><span class="p">:</span>
 1806             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--dockedPoses&quot;</span><span class="p">,</span> <span class="n">SDFile</span><span class="p">)</span>
 1807             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--dockedPoses&quot;</span><span class="p">,</span> <span class="n">SDFile</span><span class="p">,</span> <span class="s2">&quot;sdf sd&quot;</span><span class="p">)</span>
 1808             
 1809             <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">SDFile</span><span class="p">)</span>
 1810             <span class="n">SDFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1811             
 1812             <span class="c1"># Clean up SD file names for generating PyMOL object names...</span>
 1813             <span class="n">SDFileID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[^a-zA-Z0-9]&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">FileName</span><span class="p">)</span>
 1814             
 1815             <span class="k">if</span> <span class="n">SDFileRoot</span> <span class="ow">in</span> <span class="n">SDFilesRoots</span><span class="p">:</span>
 1816                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The SD file specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--dockedPoses</span><span class="se">\&quot;</span><span class="s2"> is not valid. It is a duplicate and has already been specified for a PDB file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SDFile</span><span class="p">))</span>
 1817             
 1818             <span class="n">SDFilesRoots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SDFileRoot</span><span class="p">)</span>
 1819             <span class="n">SDFilesIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SDFileID</span><span class="p">)</span>
 1820         
 1821         <span class="c1"># Track values...</span>
 1822         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s1">&#39;PDBFileIndices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDBFileIndex</span><span class="p">)</span>
 1823 
 1824         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;PDBFile&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBFile</span>
 1825         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;ChainID&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainID</span>
 1826         
 1827         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;LigandID&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandID</span>
 1828         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;UseSDFileAsLigandID&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">UseSDFileAsLigandID</span>
 1829         
 1830         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFiles&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">SDFiles</span>
 1831         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesRoots&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">SDFilesRoots</span>
 1832         <span class="n">DockedPosesInfo</span><span class="p">[</span><span class="s2">&quot;SDFilesIDs&quot;</span><span class="p">][</span><span class="n">PDBFileIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">SDFilesIDs</span>
 1833         
 1834     <span class="k">return</span> <span class="n">DockedPosesInfo</span>
 1835 
 1836 <span class="k">def</span> <span class="nf">ProcessResidueTypes</span><span class="p">():</span>
 1837     <span class="sd">&quot;&quot;&quot;Process residue types.&quot;&quot;&quot;</span>
 1838 
 1839     <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessResidueTypesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;-r, --residueTypes&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">])</span>
 1840     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesNamesInfo</span>
 1841     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesParamsInfo</span>
 1842 
 1843 <span class="k">def</span> <span class="nf">ProcessSaltBridgesChainResidues</span><span class="p">():</span>
 1844     <span class="sd">&quot;&quot;&quot;Process salt bridges chain residues.&quot;&quot;&quot;</span>
 1845 
 1846     <span class="n">SaltBridgesChainResiduesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessSaltBridgesChainResiduesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--saltBridgesChainResidues&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainResidues&quot;</span><span class="p">])</span>
 1847     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainResiduesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SaltBridgesChainResiduesInfo</span>
 1848 
 1849 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColors</span><span class="p">():</span>
 1850     <span class="sd">&quot;&quot;&quot;Process surface atom types colors.&quot;&quot;&quot;</span>
 1851 
 1852     <span class="n">AtomTypesColorNamesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessSurfaceAtomTypesColorsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">])</span>
 1853     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomTypesColorNamesInfo</span>
 1854 
 1855 <span class="k">def</span> <span class="nf">ProcessChainSelections</span><span class="p">():</span>
 1856     <span class="sd">&quot;&quot;&quot;Process custom selections for chains.&quot;&quot;&quot;</span>
 1857 
 1858     <span class="n">ChainSelectionsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainSelectionsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">])</span>
 1859     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelectionsInfo</span>
 1860 
 1861 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1862     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options.&quot;&quot;&quot;</span>
 1863 
 1864     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1865     
 1866     <span class="c1"># Validate options...</span>
 1867     <span class="n">ValidateOptions</span><span class="p">()</span>
 1868     
 1869     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1870     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1871     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">]</span>
 1872     
 1873     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1874 
 1875     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1876     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1877 
 1878     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1879     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1880         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1881     <span class="k">else</span><span class="p">:</span>
 1882         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1883     
 1884     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;IgnoreHydrogens&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ignoreHydrogens&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1885     
 1886     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1887     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1888     
 1889     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1890     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1891     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1892     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1893         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1894         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1895     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1896         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1897         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1898         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1899         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1900             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1901 
 1902     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DisulfideBondsChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--disulfideBondsChain&quot;</span><span class="p">]</span>
 1903     
 1904     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1905     
 1906     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandColor&quot;</span><span class="p">]</span>
 1907     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
 1908     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsSolventColor&quot;</span><span class="p">]</span>
 1909     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsInorganicColor&quot;</span><span class="p">]</span>
 1910 
 1911     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span>
 1912     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])</span>
 1913     
 1914     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketLabelColor&quot;</span><span class="p">]</span>
 1915     
 1916     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">]</span>
 1917     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">]</span>
 1918     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">]</span>
 1919     
 1920     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">]</span>
 1921     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypes&quot;</span><span class="p">]</span>
 1922     <span class="n">ProcessResidueTypes</span><span class="p">()</span>
 1923 
 1924     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChain&quot;</span><span class="p">]</span>
 1925     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainContactsColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChainContactsColor&quot;</span><span class="p">]</span>
 1926     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChainCutoff&quot;</span><span class="p">])</span>
 1927     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SaltBridgesChainResidues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChainResidues&quot;</span><span class="p">]</span>
 1928     <span class="n">ProcessSaltBridgesChainResidues</span><span class="p">()</span>
 1929     
 1930     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">]</span>
 1931     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChainSurface&quot;</span><span class="p">]</span>
 1932     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChainStyle&quot;</span><span class="p">]</span>
 1933     <span class="n">ProcessChainSelections</span><span class="p">()</span>
 1934     
 1935     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">]</span>
 1936     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">]</span>
 1937     
 1938     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1939     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1940     
 1941     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColor&quot;</span><span class="p">]</span>
 1942     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">]</span>
 1943     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1944     <span class="n">ProcessSurfaceAtomTypesColors</span><span class="p">()</span>
 1945     
 1946     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1947     
 1948     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1949     <span class="n">RetrieveRefFileInfo</span><span class="p">()</span>
 1950     
 1951     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1952     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1953     
 1954     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1955     
 1956     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DockedPoses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--dockedPoses&quot;</span><span class="p">]</span>
 1957     <span class="n">ProcessDockedPoses</span><span class="p">()</span>
 1958 
 1959 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1960     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options.&quot;&quot;&quot;</span>
 1961     
 1962     <span class="c1"># Get options...</span>
 1963     <span class="k">global</span> <span class="n">Options</span>
 1964     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1965 
 1966     <span class="c1"># Set current working directory to the specified directory...</span>
 1967     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1968     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1969         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1970     
 1971     <span class="c1"># Handle examples option...</span>
 1972     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1973         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1974         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1975 
 1976 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1977     <span class="sd">&quot;&quot;&quot;Validate option values.&quot;&quot;&quot;</span>
 1978     
 1979     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--align&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1980     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">],</span> <span class="s2">&quot;align cealign super&quot;</span><span class="p">)</span>
 1981     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">],</span> <span class="s2">&quot;FirstChain Complex&quot;</span><span class="p">)</span>
 1982     
 1983     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1984 
 1985     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1986     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1987     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">):</span>
 1988         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1989 
 1990     <span class="c1"># Validate file extensions...</span>
 1991     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1992         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1993         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1994         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1995     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1996     
 1997     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1998     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1999 
 2000     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 2001         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 2002             <span class="n">AlignRefFile</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 2003             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">)</span>
 2004             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 2005             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;--AlignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 2006     
 2007     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--disulfideBondsChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--disulfideBondsChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2008     
 2009     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--ignoreHydrogens&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ignoreHydrogens&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 2010     
 2011     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 2012     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 2013 
 2014     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 2015     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 2016     <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])):</span>
 2017         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--pocketContactsCutoff</span><span class="se">\&quot;</span><span class="s2"> must be less than value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-pocketDistanceCutoff</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">]))</span>
 2018         
 2019     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2020     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2021     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2022     
 2023     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2024 
 2025     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--saltBridgesChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2026     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--saltBridgesChainCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--saltBridgesChainCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 2027     
 2028     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 2029     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 2030     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2031     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 2032     
 2033     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">],</span> <span class="s2">&quot;RedToWhite WhiteToGreen&quot;</span><span class="p">)</span>
 2034     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 2035     
 2036 <span class="c1"># Setup a usage string for docopt...</span>
 2037 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 2038 <span class="s2">PyMOLVisualizeMacromolecules.py - Visualize macromolecules</span>
 2039 
 2040 <span class="s2">Usage:</span>
 2041 <span class="s2">    PyMOLVisualizeMacromolecules.py [--align &lt;yes or no&gt;] [--alignMethod &lt;align, cealign, super&gt;]</span>
 2042 <span class="s2">                                    [--alignMode &lt;FirstChain or Complex&gt;] [--alignRefFile &lt;filename&gt;]</span>
 2043 <span class="s2">                                    [--allowEmptyObjects &lt;yes or no&gt;] [--chainIDs &lt;First, All or ID1,ID2...&gt;] [--disulfideBondsChain &lt;yes or no&gt;]</span>
 2044 <span class="s2">                                    [--dockedPoses &lt;PDBFile,ChainID,LigandID,SDFiles,...&gt;]</span>
 2045 <span class="s2">                                    [--ignoreHydrogens &lt;yes or no&gt;] [--ligandIDs &lt;Largest, All or ID1,ID2...&gt;] [--labelFontID &lt;number&gt;]</span>
 2046 <span class="s2">                                    [--PMLOut &lt;yes or no&gt;] [--pocketContactsInorganicColor &lt;text&gt;]</span>
 2047 <span class="s2">                                    [--pocketContactsLigandColor &lt;text&gt;] [--pocketContactsLigandHydrophobicColor &lt;text&gt;]</span>
 2048 <span class="s2">                                    [--pocketContactsSolventColor &lt;text&gt;] [--pocketContactsCutoff &lt;number&gt;]</span>
 2049 <span class="s2">                                    [--pocketDistanceCutoff &lt;number&gt;] [--pocketLabelColor &lt;text&gt;] [--pocketResidueTypes &lt;yes or no&gt;]</span>
 2050 <span class="s2">                                    [--pocketSurface &lt;yes or no&gt;] [--pocketSurfaceElectrostatics &lt;yes or no&gt;]</span>
 2051 <span class="s2">                                    [--residueTypes &lt;Type,Color,ResNames,...&gt;] [--residueTypesChain &lt;yes or no&gt;]</span>
 2052 <span class="s2">                                    [--saltBridgesChain &lt;yes or no&gt;] [--saltBridgesChainContactsColor &lt;text&gt;]</span>
 2053 <span class="s2">                                    [--saltBridgesChainCutoff &lt;number&gt;] [--saltBridgesChainResidues &lt;Type, ResNames,...&gt;]</span>
 2054 <span class="s2">                                    [--selectionsChain &lt;ObjectName,SelectionSpec,...&gt;] [--selectionsChainSurface &lt;yes or no&gt;]</span>
 2055 <span class="s2">                                    [--selectionsChainStyle &lt;DisplayStyle&gt;] [--surfaceChain &lt;yes or no&gt;] [--surfaceChainElectrostatics &lt;yes or no&gt;]</span>
 2056 <span class="s2">                                    [--surfaceChainComplex &lt;yes or no&gt;] [--surfaceComplex &lt;yes or no&gt;]</span>
 2057 <span class="s2">                                    [--surfaceColor &lt;ColorName&gt;] [--surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;]</span>
 2058 <span class="s2">                                    [--surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;]</span>
 2059 <span class="s2">                                    [--surfaceTransparency &lt;number&gt;] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,infile2,infile3...&gt; -o &lt;outfile&gt;</span>
 2060 <span class="s2">    PyMOLVisualizeMacromolecules.py -h | --help | -e | --examples</span>
 2061 
 2062 <span class="s2">Description:</span>
 2063 <span class="s2">    Generate PyMOL visualization files for viewing surfaces, chains, ligands, ligand</span>
 2064 <span class="s2">    binding pockets, and interactions between ligands and binding pockets in</span>
 2065 <span class="s2">    macromolecules including proteins and nucleic acids.</span>
 2066 
 2067 <span class="s2">    The supported input file format are: PDB (.pdb), CIF (.cif)</span>
 2068 
 2069 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 2070 <span class="s2">    file (.pse)</span>
 2071 
 2072 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 2073 <span class="s2">    macromolecules. These groups and objects correspond to complexes, surfaces,</span>
 2074 <span class="s2">    chains, ligands, inorganics, ligand binding pockets, pocket, polar interactions,</span>
 2075 <span class="s2">    and pocket hydrophobic surfaces. A complete hierarchy of all possible PyMOL</span>
 2076 <span class="s2">    groups and objects is shown below:</span>
 2077 <span class="s2">    </span>
 2078 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 2079 <span class="s2">            .Complex</span>
 2080 <span class="s2">                .Complex</span>
 2081 <span class="s2">                .Surface</span>
 2082 <span class="s2">            .Chain&lt;ID&gt;</span>
 2083 <span class="s2">                .Complex</span>
 2084 <span class="s2">                    .Complex</span>
 2085 <span class="s2">                    .Surface</span>
 2086 <span class="s2">                .Chain</span>
 2087 <span class="s2">                    .Chain</span>
 2088 <span class="s2">                    .Selections</span>
 2089 <span class="s2">                        .&lt;Name1&gt;</span>
 2090 <span class="s2">                            .Selection</span>
 2091 <span class="s2">                            .Surface</span>
 2092 <span class="s2">                                .Surface</span>
 2093 <span class="s2">                                .Hydrophobicity</span>
 2094 <span class="s2">                                .Hydrophobicity_Charge</span>
 2095 <span class="s2">                        .&lt;Name2&gt;</span>
 2096 <span class="s2">                            ... ... ..</span>
 2097 <span class="s2">                    .Residues</span>
 2098 <span class="s2">                        .Aromatic</span>
 2099 <span class="s2">                            .Residues</span>
 2100 <span class="s2">                            .Surface</span>
 2101 <span class="s2">                        .Hydrophobic</span>
 2102 <span class="s2">                            .Residues</span>
 2103 <span class="s2">                            .Surface</span>
 2104 <span class="s2">                        .Polar</span>
 2105 <span class="s2">                            .Residues</span>
 2106 <span class="s2">                            .Surface</span>
 2107 <span class="s2">                        .Positively_Charged</span>
 2108 <span class="s2">                            .Residues</span>
 2109 <span class="s2">                            .Surface</span>
 2110 <span class="s2">                        .Negatively_Charged</span>
 2111 <span class="s2">                            .Residues</span>
 2112 <span class="s2">                            .Surface</span>
 2113 <span class="s2">                        .Other</span>
 2114 <span class="s2">                            .Residues</span>
 2115 <span class="s2">                            .Surface</span>
 2116 <span class="s2">                    .Surface</span>
 2117 <span class="s2">                        .Surface</span>
 2118 <span class="s2">                        .Hydrophobicity</span>
 2119 <span class="s2">                        .Hydrophobicity_Charge</span>
 2120 <span class="s2">                        .Vacuum_Electrostatics</span>
 2121 <span class="s2">                            .Contact_Potentials</span>
 2122 <span class="s2">                            .Map</span>
 2123 <span class="s2">                            .Legend</span>
 2124 <span class="s2">                            .Volume</span>
 2125 <span class="s2">                    .Disulfide_Bonds</span>
 2126 <span class="s2">                        .Residues</span>
 2127 <span class="s2">                    .Salt_Bridges</span>
 2128 <span class="s2">                        .Residues</span>
 2129 <span class="s2">                            .Positively_Charged</span>
 2130 <span class="s2">                            .Negatively_Charged</span>
 2131 <span class="s2">                        .Contacts</span>
 2132 <span class="s2">                .Solvent</span>
 2133 <span class="s2">                .Inorganic</span>
 2134 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2135 <span class="s2">                    .Ligand</span>
 2136 <span class="s2">                        .Ligand</span>
 2137 <span class="s2">                        .BallAndStick</span>
 2138 <span class="s2">                    .Pocket</span>
 2139 <span class="s2">                        .Pocket</span>
 2140 <span class="s2">                        .Polar_Contacts</span>
 2141 <span class="s2">                        .Hydrophobic_Contacts</span>
 2142 <span class="s2">                        .Residues</span>
 2143 <span class="s2">                            .Aromatic</span>
 2144 <span class="s2">                                .Residues</span>
 2145 <span class="s2">                                .Surface</span>
 2146 <span class="s2">                            .Hydrophobic</span>
 2147 <span class="s2">                                .Residues</span>
 2148 <span class="s2">                                .Surface</span>
 2149 <span class="s2">                            .Polar</span>
 2150 <span class="s2">                                .Residues</span>
 2151 <span class="s2">                                .Surface</span>
 2152 <span class="s2">                            .Positively_Charged</span>
 2153 <span class="s2">                                .Residues</span>
 2154 <span class="s2">                                .Surface</span>
 2155 <span class="s2">                            .Negatively_Charged</span>
 2156 <span class="s2">                                .Residues</span>
 2157 <span class="s2">                                .Surface</span>
 2158 <span class="s2">                            .Other</span>
 2159 <span class="s2">                                .Residues</span>
 2160 <span class="s2">                                .Surface</span>
 2161 <span class="s2">                        .Surfaces</span>
 2162 <span class="s2">                            .Surface</span>
 2163 <span class="s2">                                .Surface</span>
 2164 <span class="s2">                                .Hydrophobicity</span>
 2165 <span class="s2">                                .Hydrophobicity_Charge</span>
 2166 <span class="s2">                                .Vacuum_Electrostatics</span>
 2167 <span class="s2">                                    .Contact_Potentials</span>
 2168 <span class="s2">                                    .Map</span>
 2169 <span class="s2">                                    .Legend</span>
 2170 <span class="s2">                            .Cavity</span>
 2171 <span class="s2">                                .Surface</span>
 2172 <span class="s2">                                .Hydrophobicity</span>
 2173 <span class="s2">                                .Hydrophobicity_Charge</span>
 2174 <span class="s2">                                .Vacuum_Electrostatics</span>
 2175 <span class="s2">                                    .Contact_Potentials</span>
 2176 <span class="s2">                                    .Map</span>
 2177 <span class="s2">                                    .Legend</span>
 2178 <span class="s2">                    .Pocket_Solvent</span>
 2179 <span class="s2">                        .Pocket_Solvent</span>
 2180 <span class="s2">                        .Polar_Contacts</span>
 2181 <span class="s2">                    .Pocket_Inorganic</span>
 2182 <span class="s2">                        .Pocket_Inorganic</span>
 2183 <span class="s2">                        .Polar_Contacts</span>
 2184 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2185 <span class="s2">                    .Ligand</span>
 2186 <span class="s2">                        ... ... ...</span>
 2187 <span class="s2">                    .Pocket</span>
 2188 <span class="s2">                        ... ... ...</span>
 2189 <span class="s2">                    .Pocket_Solvent</span>
 2190 <span class="s2">                        ... ... ...</span>
 2191 <span class="s2">                    .Pocket_Inorganic</span>
 2192 <span class="s2">                        ... ... ...</span>
 2193 <span class="s2">                .Docked_Poses</span>
 2194 <span class="s2">                    .&lt;SDFileID&gt;</span>
 2195 <span class="s2">                        .Poses</span>
 2196 <span class="s2">                        .Pocket</span>
 2197 <span class="s2">                        .Polar_Contacts</span>
 2198 <span class="s2">                        .Hydrophobic_Contacts</span>
 2199 <span class="s2">                    .&lt;SDFileID&gt;</span>
 2200 <span class="s2">                        ... ... ...</span>
 2201 <span class="s2">                    .&lt;SDFileID&gt;</span>
 2202 <span class="s2">                        ... ... ...</span>
 2203 <span class="s2">            .Chain&lt;ID&gt;</span>
 2204 <span class="s2">                ... ... ...</span>
 2205 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2206 <span class="s2">                    ... ... ...</span>
 2207 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2208 <span class="s2">                    ... ... ...</span>
 2209 <span class="s2">            .Chain&lt;ID&gt;</span>
 2210 <span class="s2">                ... ... ...</span>
 2211 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 2212 <span class="s2">            .Complex</span>
 2213 <span class="s2">                ... ... ...</span>
 2214 <span class="s2">            .Chain&lt;ID&gt;</span>
 2215 <span class="s2">                ... ... ...</span>
 2216 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2217 <span class="s2">                    ... ... ...</span>
 2218 <span class="s2">                .Ligand&lt;ID&gt;</span>
 2219 <span class="s2">                    ... ... ...</span>
 2220 <span class="s2">            .Chain&lt;ID&gt;</span>
 2221 <span class="s2">                ... ... ...</span>
 2222 <span class="s2">    </span>
 2223 <span class="s2">    The hydrophobic and electrostatic surfaces are not created for complete complex</span>
 2224 <span class="s2">    and chain complex in input file(s) by default. A word to the wise: The creation of</span>
 2225 <span class="s2">    surface objects may slow down loading of PML file and generation of PSE file, based</span>
 2226 <span class="s2">    on the size of input complexes. The generation of PSE file may also fail.</span>
 2227 
 2228 <span class="s2">Options:</span>
 2229 <span class="s2">    -a, --align &lt;yes or no&gt;  [default: no]</span>
 2230 <span class="s2">        Align input files to a reference file before visualization.</span>
 2231 <span class="s2">    --alignMethod &lt;align, cealign, super&gt;  [default: super]</span>
 2232 <span class="s2">        Alignment methodology to use for aligning input files to a</span>
 2233 <span class="s2">        reference file.</span>
 2234 <span class="s2">    --alignMode &lt;FirstChain or Complex&gt;  [default: FirstChain]</span>
 2235 <span class="s2">        Portion of input and reference files to use for spatial alignment of</span>
 2236 <span class="s2">        input files against reference file.  Possible values: FirstChain or</span>
 2237 <span class="s2">        Complex.</span>
 2238 <span class="s2">        </span>
 2239 <span class="s2">        The FirstChain mode allows alignment of the first chain in each input</span>
 2240 <span class="s2">        file to the first chain in the reference file along with moving the rest</span>
 2241 <span class="s2">        of the complex to coordinate space of the reference file. The complete</span>
 2242 <span class="s2">        complex in each input file is aligned to the complete complex in reference</span>
 2243 <span class="s2">        file for the Complex mode.</span>
 2244 <span class="s2">    --alignRefFile &lt;filename&gt;  [default: FirstInputFile]</span>
 2245 <span class="s2">        Reference input file name. The default is to use the first input file</span>
 2246 <span class="s2">        name specified using &#39;-i, --infiles&#39; option.</span>
 2247 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 2248 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 2249 <span class="s2">        inorganic atom selections across chains and ligands in input file(s). By</span>
 2250 <span class="s2">        default, the empty objects are marked for deletion.</span>
 2251 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 2252 <span class="s2">        List of chain IDs to use for visualizing macromolecules. Possible values:</span>
 2253 <span class="s2">        First, All, or a comma delimited list of chain IDs. The default is to use the</span>
 2254 <span class="s2">        chain ID for the first chain in each input file.</span>
 2255 <span class="s2">    -d --disulfideBondsChain &lt;yes or no&gt;  [default: auto]</span>
 2256 <span class="s2">        Disulfide bonds for chains. By default, the disulfide bonds group is</span>
 2257 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 2258 <span class="s2">        chains only containing nucleic acids.</span>
 2259 <span class="s2">    --dockedPoses &lt;PDBFile,ChainID,LigandID,SDFiles,...&gt;  [default: none]</span>
 2260 <span class="s2">        PDB file name, pocket chain ID, ligand specification, and SD files to use</span>
 2261 <span class="s2">        for creating pockets to visualize docked poses.</span>
 2262 <span class="s2">        </span>
 2263 <span class="s2">        It&#39;s a quartet of comma limited values corresponding to PDF file name,</span>
 2264 <span class="s2">        pocket chain ID, ligand ID, and SD files. Multiple SD file names are delimited</span>
 2265 <span class="s2">        by space.</span>
 2266 <span class="s2">        </span>
 2267 <span class="s2">        The supported values for docked poses are shown below:</span>
 2268 <span class="s2">             </span>
 2269 <span class="s2">            PDBFile: A valid PDB file name</span>
 2270 <span class="s2">            ChainID: A valid Chain ID</span>
 2271 <span class="s2">            LigandID: A valid Ligand ID or UseSDFile</span>
 2272 <span class="s2">            SDFiles: A space delimited list of SD file names</span>
 2273 <span class="s2">             </span>
 2274 <span class="s2">        All docked pose values must be specified. No default values are assigned.</span>
 2275 <span class="s2">        </span>
 2276 <span class="s2">        The &#39;ChainID&#39; and &#39;LigandID&#39; are used for creating pocket to visualize docked</span>
 2277 <span class="s2">        poses.</span>
 2278 <span class="s2">        </span>
 2279 <span class="s2">        The &#39;LigandID&#39; must be a valid ligand ID in &#39;ChainID&#39;. Alternatively, you may use</span>
 2280 <span class="s2">        SD files by specifying &#39;UseSDFile&#39; &#39;to select residues in &#39;ChainID&#39; for creating</span>
 2281 <span class="s2">        pockets to visualize docked poses.</span>
 2282 <span class="s2">    -e, --examples</span>
 2283 <span class="s2">        Print examples.</span>
 2284 <span class="s2">    -h, --help</span>
 2285 <span class="s2">        Print this help message.</span>
 2286 <span class="s2">    -i, --infiles &lt;infile1,infile2,infile3...&gt;</span>
 2287 <span class="s2">        Input file names.</span>
 2288 <span class="s2">    --ignoreHydrogens &lt;yes or no&gt;  [default: yes]</span>
 2289 <span class="s2">        Ignore hydrogens for ligand, pocket, selection, and residue type views.</span>
 2290 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: Largest]</span>
 2291 <span class="s2">        List of ligand IDs present in chains for visualizing macromolecules to</span>
 2292 <span class="s2">        highlight ligand interactions. Possible values: Largest, All, or a comma</span>
 2293 <span class="s2">        delimited list of ligand IDs. The default is to use the largest ligand present</span>
 2294 <span class="s2">        in all or specified chains in each input file.</span>
 2295 <span class="s2">        </span>
 2296 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 2297 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 2298 <span class="s2">        the highest number of heavy atoms.</span>
 2299 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 2300 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 2301 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 2302 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 2303 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 2304 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 2305 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 2306 <span class="s2">        Output file name.</span>
 2307 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 2308 <span class="s2">        Save PML file during generation of PSE file.</span>
 2309 <span class="s2">    --pocketContactsInorganicColor &lt;text&gt;  [default: deepsalmon]</span>
 2310 <span class="s2">        Color for drawing polar contacts between inorganic and pocket residues.</span>
 2311 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2312 <span class="s2">    --pocketContactsLigandColor &lt;text&gt;  [default: orange]</span>
 2313 <span class="s2">        Color for drawing polar contacts between ligand and pocket residues.</span>
 2314 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2315 <span class="s2">    --pocketContactsLigandHydrophobicColor &lt;text&gt;  [default: purpleblue]</span>
 2316 <span class="s2">        Color for drawing hydrophobic contacts between ligand and pocket residues.</span>
 2317 <span class="s2">        The specified value must be valid color. No validation is performed. The</span>
 2318 <span class="s2">        hydrophobic contacts are shown between pairs of carbon atoms not</span>
 2319 <span class="s2">        connected to hydrogen bond donor or acceptors atoms as identified</span>
 2320 <span class="s2">        by PyMOL.</span>
 2321 <span class="s2">    --pocketContactsSolventColor &lt;text&gt;  [default: marine]</span>
 2322 <span class="s2">        Color for drawing polar contacts between solvent and pocket residues..</span>
 2323 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2324 <span class="s2">    --pocketContactsCutoff &lt;number&gt;  [default: 4.0]</span>
 2325 <span class="s2">        Distance in Angstroms for identifying polar and hyrdophobic contacts</span>
 2326 <span class="s2">        between atoms in pocket residues and ligands.</span>
 2327 <span class="s2">    --pocketDistanceCutoff &lt;number&gt;  [default: 5.0]</span>
 2328 <span class="s2">        Distance in Angstroms for identifying pocket residues around ligands.</span>
 2329 <span class="s2">    --pocketLabelColor &lt;text&gt;  [default: magenta]</span>
 2330 <span class="s2">        Color for drawing residue or atom level labels for a pocket. The specified</span>
 2331 <span class="s2">        value must be valid color. No validation is performed.</span>
 2332 <span class="s2">    --pocketResidueTypes &lt;yes or no&gt;  [default: auto]</span>
 2333 <span class="s2">        Pocket residue types. The residue groups are generated using residue types,</span>
 2334 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 2335 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 2336 <span class="s2">        for pockets containing amino acids and skipped for chains only containing</span>
 2337 <span class="s2">        nucleic acids.</span>
 2338 <span class="s2">    --pocketSurface &lt;yes or no&gt;  [default: auto]</span>
 2339 <span class="s2">        Surfaces around pocket residues colored by hydrophobicity alone and</span>
 2340 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 2341 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 2342 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 2343 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 2344 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 2345 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 2346 <span class="s2">        </span>
 2347 <span class="s2">        The cavity surfaces around ligands are also generated. These surfaces are</span>
 2348 <span class="s2">        colored by hydrophobicity along and both hydrophobicity and charge.</span>
 2349 <span class="s2">        </span>
 2350 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 2351 <span class="s2">        automatically created for pockets containing amino acids and skipped for</span>
 2352 <span class="s2">        pockets containing only nucleic acids.</span>
 2353 <span class="s2">    --pocketSurfaceElectrostatics &lt;yes or no&gt;  [default: no]</span>
 2354 <span class="s2">        Vacuum electrostatics contact potential surface around pocket residues.</span>
 2355 <span class="s2">        A word to the wise from PyMOL documentation: The computed protein</span>
 2356 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 2357 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 2358 <span class="s2">        </span>
 2359 <span class="s2">        The cavity surface around ligands is also generated. This surface is</span>
 2360 <span class="s2">        colored by vacuum electrostatics contact potential.</span>
 2361 <span class="s2">        </span>
 2362 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 2363 <span class="s2">        is automatically created for chains containing amino acids and skipped for chains</span>
 2364 <span class="s2">        containing only nucleic acids.</span>
 2365 <span class="s2">    -r, --residueTypes &lt;Type,Color,ResNames,...&gt;  [default: auto]</span>
 2366 <span class="s2">        Residue types, colors, and names to generate for residue groups during</span>
 2367 <span class="s2">        &#39;--pocketResidueTypes&#39; and &#39;--residueTypesChain&#39; option. It is only</span>
 2368 <span class="s2">        valid for amino acids.</span>
 2369 <span class="s2">        </span>
 2370 <span class="s2">        It is a triplet of comma delimited list of amino acid residues type, residues</span>
 2371 <span class="s2">        color, and a space delimited list three letter residue names. </span>
 2372 <span class="s2">        </span>
 2373 <span class="s2">        The default values for residue type, color, and name triplets  are shown</span>
 2374 <span class="s2">        below:</span>
 2375 <span class="s2">            </span>
 2376 <span class="s2">            Aromatic,brightorange,HIS PHE TRP TYR,</span>
 2377 <span class="s2">            Hydrophobic,orange,ALA GLY VAL LEU ILE PRO MET,</span>
 2378 <span class="s2">            Polar,palegreen,ASN GLN SER THR CYS,</span>
 2379 <span class="s2">            Positively_Charged,marine,ARG LYS,</span>
 2380 <span class="s2">            Negatively_Charged,red,ASP GLU</span>
 2381 <span class="s2">            </span>
 2382 <span class="s2">        The color name must be a valid PyMOL name. No validation is performed.</span>
 2383 <span class="s2">        An amino acid name may appear across multiple residue types. All other</span>
 2384 <span class="s2">        residues are grouped under &#39;Other&#39;.</span>
 2385 <span class="s2">    --residueTypesChain &lt;yes or no&gt;  [default: auto]</span>
 2386 <span class="s2">        Chain residue types. The residue groups are generated using residue types,</span>
 2387 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 2388 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 2389 <span class="s2">        for chains containing amino acids and skipped for chains only containing</span>
 2390 <span class="s2">        nucleic acids.</span>
 2391 <span class="s2">     --saltBridgesChain &lt;yes or no&gt;  [default: auto]</span>
 2392 <span class="s2">        Salt bridges for chains. By default, the salt bridges group is automatically</span>
 2393 <span class="s2">        created for chains containing amino acids and skipped for chains only</span>
 2394 <span class="s2">        containing nucleic acids. The salt bridges correspond to polar contacts</span>
 2395 <span class="s2">        between positively and negatively charges residues in a chain.</span>
 2396 <span class="s2">    --saltBridgesChainContactsColor &lt;text&gt;  [default: brightorange]</span>
 2397 <span class="s2">        Color for drawing polar contacts between positively and negatively</span>
 2398 <span class="s2">        charged residues involved in salt bridges. The specified value must</span>
 2399 <span class="s2">        be valid color. No validation is performed.</span>
 2400 <span class="s2">    --saltBridgesChainCutoff &lt;number&gt;  [default: 4.0]</span>
 2401 <span class="s2">        Distance in Angstroms for identifying polar contacts between positively</span>
 2402 <span class="s2">        and negatively charged residues involved in salt bridges in a chain.</span>
 2403 <span class="s2">     --saltBridgesChainResidues &lt;Type, ResNames,...&gt;  [default: auto]</span>
 2404 <span class="s2">        Residue types and names to use for identifying positively and negatively</span>
 2405 <span class="s2">        charged residues involved in salt bridges.</span>
 2406 <span class="s2">        </span>
 2407 <span class="s2">        It is a pair of comma delimited list of amino acid residue types and a space</span>
 2408 <span class="s2">        delimited list three letter residue names.</span>
 2409 <span class="s2">        </span>
 2410 <span class="s2">        The default values for residue type and name pairs  are shown below:</span>
 2411 <span class="s2">            </span>
 2412 <span class="s2">            Positively_Charged,ARG LYS HIS HSP</span>
 2413 <span class="s2">            Negatively_Charged,ASP GLU</span>
 2414 <span class="s2">            </span>
 2415 <span class="s2">        The residue names must be valid names. No validation is performed.</span>
 2416 <span class="s2">    --selectionsChain &lt;ObjectName,SelectionSpec,...&gt;  [default: None]</span>
 2417 <span class="s2">        Custom selections for chains. It is a pairwise list of comma delimited values</span>
 2418 <span class="s2">        corresponding to PyMOL object names and selection specifications.  The</span>
 2419 <span class="s2">        selection specification must be a valid PyMOL specification. No validation is</span>
 2420 <span class="s2">        performed.</span>
 2421 <span class="s2">        </span>
 2422 <span class="s2">        The PyMOL objects are created for each chain corresponding to the</span>
 2423 <span class="s2">        specified selections. The display style for PyMOL objects is set using</span>
 2424 <span class="s2">        value of &#39;--selectionsChainStyle&#39; option.</span>
 2425 <span class="s2">        </span>
 2426 <span class="s2">        The specified selection specification is automatically appended to appropriate</span>
 2427 <span class="s2">        chain specification before creating PyMOL objects.</span>
 2428 <span class="s2">        </span>
 2429 <span class="s2">        For example, the following specification for &#39;--selectionsChain&#39; option will</span>
 2430 <span class="s2">        generate PyMOL objects for chains containing Cysteines and Serines:</span>
 2431 <span class="s2">            </span>
 2432 <span class="s2">            Cysteines,resn CYS,Serines,resn SER</span>
 2433 <span class="s2">            </span>
 2434 <span class="s2">    --selectionsChainSurface &lt;yes or no&gt;  [default: auto]</span>
 2435 <span class="s2">        Surfaces around individual chain selections colored by hydrophobicity alone</span>
 2436 <span class="s2">        and both hydrophobicity and charge. This option is similar to &#39;--surfaceChain&#39;</span>
 2437 <span class="s2">        options for creating surfaces for chain. Additional details are available in the</span>
 2438 <span class="s2">        documentation section for &#39;--surfaceChain&#39; options.</span>
 2439 <span class="s2">    --selectionsChainStyle &lt;DisplayStyle&gt;  [default: sticks]</span>
 2440 <span class="s2">        Display style for PyMOL objects created for &#39;--selectionsChain&#39; option. It</span>
 2441 <span class="s2">        must be a valid PyMOL display style. No validation is performed.</span>
 2442 <span class="s2">    --surfaceChain &lt;yes or no&gt;  [default: auto]</span>
 2443 <span class="s2">        Surfaces around individual chain colored by hydrophobicity alone and</span>
 2444 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 2445 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 2446 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 2447 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 2448 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 2449 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 2450 <span class="s2">        </span>
 2451 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 2452 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 2453 <span class="s2">        chains containing only nucleic acids.</span>
 2454 <span class="s2">    --surfaceChainElectrostatics &lt;yes or no&gt;  [default: no]</span>
 2455 <span class="s2">        Vacuum electrostatics contact potential surface and volume around individual</span>
 2456 <span class="s2">        chain. A word to the wise from PyMOL documentation: The computed protein</span>
 2457 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 2458 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 2459 <span class="s2">        </span>
 2460 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 2461 <span class="s2">        and volume are automatically created for chains containing amino acids and</span>
 2462 <span class="s2">        skipped for chains containing only nucleic acids.</span>
 2463 <span class="s2">    --surfaceChainComplex &lt;yes or no&gt;  [default: no]</span>
 2464 <span class="s2">        Hydrophobic surface around chain complex. The  surface is colored by</span>
 2465 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 2466 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 2467 <span class="s2">        Hydrophobic surface around complete complex. The  surface is colored by</span>
 2468 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 2469 <span class="s2">    --surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;  [default: auto]</span>
 2470 <span class="s2">        Atom colors for generating surfaces colored by hyrophobicity and charge</span>
 2471 <span class="s2">        around chains and pockets in proteins. It&#39;s a pairwise comma delimited list</span>
 2472 <span class="s2">        of atom color type and color specification for goups of atoms.</span>
 2473 <span class="s2">        </span>
 2474 <span class="s2">        The default values for color types [ Ref 140 ] along wth color specifications</span>
 2475 <span class="s2">        are shown below: </span>
 2476 <span class="s2">            </span>
 2477 <span class="s2">            HydrophobicAtomsColor, yellow,</span>
 2478 <span class="s2">            NegativelyChargedAtomsColor, red,</span>
 2479 <span class="s2">            PositivelyChargedAtomsColor, blue,</span>
 2480 <span class="s2">            OtherAtomsColor, gray90</span>
 2481 <span class="s2">            </span>
 2482 <span class="s2">        The color names must be valid PyMOL names.</span>
 2483 <span class="s2">        </span>
 2484 <span class="s2">        The color values may also be specified as space delimited RGB triplets:</span>
 2485 <span class="s2">             </span>
 2486 <span class="s2">            HydrophobicAtomsColor, 0.95 0.78 0.0,</span>
 2487 <span class="s2">            NegativelyChargedAtomsColor, 1.0 0.4 0.4,</span>
 2488 <span class="s2">            PositivelyChargedAtomsColor, 0.2 0.5 0.8,</span>
 2489 <span class="s2">            OtherAtomsColor, 0.95 0.95 0.95</span>
 2490 <span class="s2">            </span>
 2491 <span class="s2">    --surfaceColor &lt;ColorName&gt;  [default: lightblue]</span>
 2492 <span class="s2">        Color name for surfaces around chains and pockets. This color is not used</span>
 2493 <span class="s2">        for surfaces colored by hydrophobicity and charge. The color name must be</span>
 2494 <span class="s2">        a valid PyMOL name.</span>
 2495 <span class="s2">    --surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;  [default: RedToWhite]</span>
 2496 <span class="s2">        Color palette for hydrophobic surfaces around chains and pockets in proteins.</span>
 2497 <span class="s2">        Possible values: RedToWhite or WhiteToGreen from most hydrophobic amino</span>
 2498 <span class="s2">        acid to least hydrophobic. The colors values for amino acids are taken from</span>
 2499 <span class="s2">        color_h script available as part of the Script Library at PyMOL Wiki.</span>
 2500 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 2501 <span class="s2">        Surface transparency for molecular surfaces.</span>
 2502 <span class="s2">    --overwrite</span>
 2503 <span class="s2">        Overwrite existing files.</span>
 2504 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 2505 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 2506 
 2507 <span class="s2">Examples:</span>
 2508 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 2509 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 2510 <span class="s2">    and inorganics, in a PDB file, and generate a PML file, type:</span>
 2511 
 2512 <span class="s2">        % PyMOLVisualizeMacromolecules.py -i Sample4.pdb -o Sample4.pml</span>
 2513 
 2514 <span class="s2">    To visualize the first chain along with all cysteines and serines, the largest</span>
 2515 <span class="s2">    ligand in the first chain, and ligand binding pockets to highlight ligand</span>
 2516 <span class="s2">    interaction with pocket resiudes, solvents and inorganics, in a PDB file,</span>
 2517 <span class="s2">    and generate a PML file, type:</span>
 2518 
 2519 <span class="s2">        % PyMOLVisualizeMacromolecules.py -i Sample4.pdb -o Sample4.pml</span>
 2520 <span class="s2">          --selectionsChain &quot;Cysteines,resn cys,Serines,resn ser&quot;</span>
 2521 
 2522 <span class="s2">    To visualize docking poses from a SD file in a pocket corresponding to a specific</span>
 2523 <span class="s2">    ligand and a chain, along with visualization of other information, in a PDB file,</span>
 2524 <span class="s2">    and generate a PML file, type:</span>
 2525 
 2526 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l &quot;N3&quot; -i  SampleMpro6LU7.pdb</span>
 2527 <span class="s2">          -o  SampleMpro6LU7.pml --dockedPoses &quot;SampleMpro6LU7.pdb,A,N3,</span>
 2528 <span class="s2">          SampleMproDockedPosesTop100.sdf&quot;</span>
 2529 <span class="s2">    </span>
 2530 <span class="s2">    To visualize docking poses from a SD file in a pocket corresponding to SD file</span>
 2531 <span class="s2">    for a chain, along with visualization of other information, in a PDB file,</span>
 2532 <span class="s2">    and generate a PML file, type:</span>
 2533 
 2534 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l &quot;N3&quot; -i  SampleMpro6LU7.pdb</span>
 2535 <span class="s2">          -o  SampleMpro6LU7.pml --dockedPoses &quot;SampleMpro6LU7.pdb,A,UseSDFile,</span>
 2536 <span class="s2">          SampleMproDockedPosesTop100.sdf&quot;</span>
 2537 <span class="s2">    </span>
 2538 <span class="s2">    To visualize docking poses from multiple SDs file in a pocket corresponding to</span>
 2539 <span class="s2">    a specific ligand and a chain, along with visualization of other information, in a</span>
 2540 <span class="s2">    PDB file, and generate a PML file, type: </span>
 2541 
 2542 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l &quot;N3&quot; -i  SampleMpro6LU7.pdb</span>
 2543 <span class="s2">          -o  SampleMpro6LU7.pml --dockedPoses &quot;SampleMpro6LU7.pdb,A,N3,</span>
 2544 <span class="s2">          SampleMproDockedPosesTop100.sdf SampleMproDockedPosesDiverse100.sdf&quot;</span>
 2545 
 2546 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2547 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in a</span>
 2548 <span class="s2">    PDB file, and generate a PML file, type:</span>
 2549 
 2550 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All -i Sample4.pdb -o</span>
 2551 <span class="s2">          Sample4.pml</span>
 2552 
 2553 <span class="s2">    To visualize all chains, ligands, and ligand binding pockets along with displaying</span>
 2554 <span class="s2">    all hydrophibic surfaces and chain electrostatic surface, in a PDB file, and</span>
 2555 <span class="s2">    generate a PML file, type:</span>
 2556 
 2557 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All</span>
 2558 <span class="s2">          --surfaceChainElectrostatics yes --surfaceChainComplex yes</span>
 2559 <span class="s2">          --surfaceComplex yes -i Sample4.pdb -o Sample4.pml</span>
 2560 
 2561 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 2562 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 2563 <span class="s2">    in a PDB file, and generate a PML file, type:</span>
 2564 
 2565 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 2566 <span class="s2">          -o Sample3.pml</span>
 2567 
 2568 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 2569 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 2570 <span class="s2">    in a PDB file, and generate a PSE file, type:</span>
 2571 
 2572 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 2573 <span class="s2">          -o Sample3.pse</span>
 2574 
 2575 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 2576 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 2577 <span class="s2">    and inorganics, in PDB files, along with aligning first chain in each input file to</span>
 2578 <span class="s2">    the first chain in first input file, and generate a PML file, type:</span>
 2579 
 2580 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes -i</span>
 2581 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2582 
 2583 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2584 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 2585 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in</span>
 2586 <span class="s2">    first input file, and generate a PML file, type:</span>
 2587 
 2588 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  -c All -l All -i</span>
 2589 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2590 
 2591 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2592 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 2593 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in a</span>
 2594 <span class="s2">    specified PDB file using a specified alignment method, and generate a PML</span>
 2595 <span class="s2">    file, type:</span>
 2596 
 2597 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  --alignMode FirstChain</span>
 2598 <span class="s2">          --alignRefFile Sample5.pdb --alignMethod super   -c All  -l All -i</span>
 2599 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2600 
 2601 <span class="s2">Author:</span>
 2602 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 2603 
 2604 <span class="s2">See also:</span>
 2605 <span class="s2">    DownloadPDBFiles.pl, PyMOLVisualizeCavities.py,</span>
 2606 <span class="s2">    PyMOLVisualizeCryoEMDensity.py, PyMOLVisualizeElectronDensity.py,</span>
 2607 <span class="s2">    PyMOLVisualizeInterfaces.py, PyMOLVisualizeSurfaceAndBuriedResidues.py</span>
 2608 
 2609 <span class="s2">Copyright:</span>
 2610 <span class="s2">    Copyright (C) 2022 Manish Sud. All rights reserved.</span>
 2611 
 2612 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 2613 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 2614 <span class="s2">    developed by Warren DeLano.</span>
 2615 
 2616 <span class="s2">    This file is part of MayaChemTools.</span>
 2617 
 2618 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 2619 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 2620 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 2621 <span class="s2">    later version.</span>
 2622 
 2623 <span class="s2">&quot;&quot;&quot;</span>
 2624 
 2625 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 2626     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
