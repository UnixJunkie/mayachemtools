<html>
<head>
<title>MayaChemTools:Code:Python/MiscUtil.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1"># File: MiscUtil.py</span>
    3 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    4 <span class="c1">#</span>
    5 <span class="c1"># Copyright (C) 2022 Manish Sud. All rights reserved.</span>
    6 <span class="c1">#</span>
    7 <span class="c1"># This file is part of MayaChemTools.</span>
    8 <span class="c1">#</span>
    9 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   10 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   11 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   12 <span class="c1"># later version.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   15 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   16 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   17 <span class="c1"># details.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   20 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   21 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   22 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   23 <span class="c1">#</span>
   24 
   25 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   26 
   27 <span class="kn">import</span> <span class="nn">os</span>
   28 <span class="kn">import</span> <span class="nn">sys</span>
   29 <span class="kn">import</span> <span class="nn">time</span>
   30 <span class="kn">import</span> <span class="nn">re</span>
   31 <span class="kn">import</span> <span class="nn">csv</span>
   32 <span class="kn">import</span> <span class="nn">textwrap</span>
   33 <span class="kn">import</span> <span class="nn">glob</span>
   34 <span class="kn">import</span> <span class="nn">base64</span>
   35 <span class="kn">import</span> <span class="nn">pickle</span>
   36 <span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="kn">as</span> <span class="nn">mp</span>
   37 
   38 <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CheckFileExt&quot;</span><span class="p">,</span> <span class="s2">&quot;CheckTextValue&quot;</span><span class="p">,</span> <span class="s2">&quot;DoesSMILESFileContainTitleLine&quot;</span><span class="p">,</span> <span class="s2">&quot;ExpandFileNames&quot;</span><span class="p">,</span> <span class="s2">&quot;GetExamplesTextFromDocOptText&quot;</span><span class="p">,</span>  <span class="s2">&quot;GetExcelStyleColumnLabel&quot;</span><span class="p">,</span> <span class="s2">&quot;GetMayaChemToolsLibDataPath&quot;</span><span class="p">,</span> <span class="s2">&quot;GetMayaChemToolsVersion&quot;</span><span class="p">,</span> <span class="s2">&quot;GetTextLines&quot;</span><span class="p">,</span> <span class="s2">&quot;GetTextLinesWords&quot;</span><span class="p">,</span> <span class="s2">&quot;GetWallClockAndProcessorTime&quot;</span><span class="p">,</span> <span class="s2">&quot;GetFormattedElapsedTime&quot;</span><span class="p">,</span> <span class="s2">&quot;GetFormattedFileSize&quot;</span><span class="p">,</span> <span class="s2">&quot;IsEmpty&quot;</span><span class="p">,</span> <span class="s2">&quot;IsFloat&quot;</span><span class="p">,</span> <span class="s2">&quot;IsInteger&quot;</span><span class="p">,</span> <span class="s2">&quot;IsNumber&quot;</span><span class="p">,</span> <span class="s2">&quot;JoinWords&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectFromBase64EncodedString&quot;</span><span class="p">,</span> <span class="s2">&quot;ObjectToBase64EncodedString&quot;</span><span class="p">,</span> <span class="s2">&quot;ParseFileName&quot;</span><span class="p">,</span> <span class="s2">&quot;PrintError&quot;</span><span class="p">,</span> <span class="s2">&quot;PrintInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;PrintWarning&quot;</span><span class="p">,</span>  <span class="s2">&quot;ProcessOptionConformerParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionInfileParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionMultiprocessingParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionNameValuePairParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionOutfileParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionPyMOLCubeFileViewParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessOptionSeabornPlotParameters&quot;</span><span class="p">,</span> <span class="s2">&quot;ReplaceHTMLEntitiesInText&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionsDistinctFileNames&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionFileExt&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionFilePath&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionFloatValue&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionIntegerValue&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionNumberValue&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionNumberValues&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionsOutputFileOverwrite&quot;</span><span class="p">,</span> <span class="s2">&quot;ValidateOptionTextValue&quot;</span><span class="p">,</span>  <span class="s2">&quot;TruncateText&quot;</span><span class="p">,</span> <span class="s2">&quot;WrapText&quot;</span><span class="p">]</span>
   39 
   40 <span class="k">def</span> <span class="nf">CheckFileExt</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="n">FileExts</span><span class="p">):</span>
   41     <span class="sd">&quot;&quot;&quot;Check file type based on the specified file extensions delimited by spaces.</span>
   42 <span class="sd">    </span>
   43 <span class="sd">    Arguments:</span>
   44 <span class="sd">        FileName (str): Name of a file.</span>
   45 <span class="sd">        FileExts (str): Space delimited string containing valid file extensions.</span>
   46 
   47 <span class="sd">    Returns:</span>
   48 <span class="sd">        bool : True, FileName contains a valid file extension; Otherwise, False.</span>
   49 
   50 <span class="sd">    &quot;&quot;&quot;</span>
   51     
   52     <span class="k">for</span> <span class="n">FileExt</span> <span class="ow">in</span> <span class="n">FileExts</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
   53         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\.</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
   54             <span class="k">return</span> <span class="bp">True</span>
   55     
   56     <span class="k">return</span> <span class="bp">False</span>
   57 
   58 <span class="k">def</span> <span class="nf">CheckTextValue</span><span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">ValidValues</span><span class="p">):</span>
   59     <span class="sd">&quot;&quot;&quot;Check text value based on the specified valid values delimited by spaces.</span>
   60 
   61 <span class="sd">    Arguments:</span>
   62 <span class="sd">        Value (str): Text value</span>
   63 <span class="sd">        ValidValues (str): Space delimited string containing valid values.</span>
   64 
   65 <span class="sd">    Returns:</span>
   66 <span class="sd">        bool : True, Value is valid; Otherwise, False.</span>
   67 
   68 <span class="sd">    &quot;&quot;&quot;</span>
   69     
   70     <span class="n">ValidValues</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;|&#39;</span><span class="p">,</span> <span class="n">ValidValues</span><span class="p">)</span>
   71     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(</span><span class="si">%s</span><span class="s2">)$&quot;</span> <span class="o">%</span> <span class="n">ValidValues</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
   72         <span class="k">return</span> <span class="bp">True</span>
   73     
   74     <span class="k">return</span> <span class="bp">False</span>
   75 
   76 <span class="k">def</span> <span class="nf">GetTextLinesWords</span><span class="p">(</span><span class="n">TextFilePath</span><span class="p">,</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">QuoteChar</span><span class="p">,</span> <span class="n">IgnoreHeaderLine</span><span class="p">):</span>
   77     <span class="sd">&quot;&quot;&quot;Parse lines in the specified text file into words in a line and return a list containing</span>
   78 <span class="sd">    list of parsed line words.</span>
   79 
   80 <span class="sd">    Arguments:</span>
   81 <span class="sd">        TextFilePath (str): Text file name including file path.</span>
   82 <span class="sd">        Delimiter (str): Delimiter for parsing text lines.</span>
   83 <span class="sd">        QuoteChar (str): Quote character for line words.</span>
   84 <span class="sd">        IgnoreHeaderLine (bool): A flag indicating whether to ignore first</span>
   85 <span class="sd">            valid data line corresponding to header line.</span>
   86 
   87 <span class="sd">    Returns:</span>
   88 <span class="sd">        list : A list of lists containing parsed words for lines.</span>
   89 
   90 <span class="sd">    Notes:</span>
   91 <span class="sd">        The lines starting with # or // are considered comment lines and are</span>
   92 <span class="sd">        ignored during parsing along with any empty lines.</span>
   93 
   94 <span class="sd">    &quot;&quot;&quot;</span>
   95     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">TextFilePath</span><span class="p">):</span>
   96         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The text file file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exist.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TextFilePath</span><span class="p">))</span>
   97     
   98     <span class="n">TextFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">TextFilePath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
   99     <span class="k">if</span> <span class="n">TextFile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  100         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t open text file: </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TextFilePath</span><span class="p">))</span>
  101 
  102     <span class="c1"># Collect text lines...</span>
  103     <span class="n">TextLines</span> <span class="o">=</span> <span class="p">[]</span>
  104     <span class="n">FirstValidLine</span> <span class="o">=</span> <span class="bp">True</span>
  105     <span class="k">for</span> <span class="n">Line</span> <span class="ow">in</span> <span class="n">TextFile</span><span class="p">:</span>
  106         <span class="n">Line</span> <span class="o">=</span> <span class="n">Line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
  107         
  108         <span class="c1"># Ignore empty lines...</span>
  109         <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>
  110             <span class="k">continue</span>
  111         
  112         <span class="c1"># Ignore comments...</span>
  113         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(#|\/\/)&quot;</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  114             <span class="k">continue</span>
  115 
  116         <span class="c1"># Ignore header line...</span>
  117         <span class="k">if</span> <span class="n">FirstValidLine</span><span class="p">:</span>
  118             <span class="n">FirstValidLine</span> <span class="o">=</span> <span class="bp">False</span>
  119             <span class="k">if</span> <span class="n">IgnoreHeaderLine</span><span class="p">:</span>
  120                 <span class="k">continue</span>
  121         
  122         <span class="n">TextLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Line</span><span class="p">)</span>
  123         
  124     <span class="n">TextFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  125 
  126     <span class="c1"># Parse text lines...</span>
  127     <span class="n">TextLinesWords</span> <span class="o">=</span> <span class="p">[]</span>
  128     
  129     <span class="n">TextLinesReader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">TextLines</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">quotechar</span> <span class="o">=</span> <span class="n">QuoteChar</span><span class="p">)</span>
  130     <span class="k">for</span> <span class="n">LineWords</span> <span class="ow">in</span> <span class="n">TextLinesReader</span><span class="p">:</span>
  131         <span class="n">TextLinesWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span>
  132     
  133     <span class="k">return</span> <span class="n">TextLinesWords</span>
  134     
  135 <span class="k">def</span> <span class="nf">GetTextLines</span><span class="p">(</span><span class="n">TextFilePath</span><span class="p">):</span>
  136     <span class="sd">&quot;&quot;&quot;Read text lines from input file, remove new line characters  and return a list containing</span>
  137 <span class="sd">    stripped lines.</span>
  138 
  139 <span class="sd">    Arguments:</span>
  140 <span class="sd">        TextFilePath (str): Text file name including file path.</span>
  141 
  142 <span class="sd">    Returns:</span>
  143 <span class="sd">        list : A list lines.</span>
  144 
  145 <span class="sd">    &quot;&quot;&quot;</span>
  146     <span class="n">TextFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">TextFilePath</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
  147     <span class="k">if</span> <span class="n">TextFile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  148         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t open text file: </span><span class="si">%s</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TextFilePath</span><span class="p">))</span>
  149 
  150     <span class="c1"># Collect text lines...</span>
  151     <span class="n">TextLines</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">Line</span> <span class="ow">in</span> <span class="n">TextFile</span><span class="p">]</span>
  152     
  153     <span class="n">TextFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  154 
  155     <span class="k">return</span> <span class="n">TextLines</span>
  156 
  157 <span class="k">def</span> <span class="nf">DoesSMILESFileContainTitleLine</span><span class="p">(</span><span class="n">FileName</span><span class="p">):</span>
  158     <span class="sd">&quot;&quot;&quot;Determine whether the SMILES file contain a title line based on the  presence</span>
  159 <span class="sd">    of a string SMILES, Name or ID in the first line.</span>
  160 
  161 <span class="sd">    Arguments:</span>
  162 <span class="sd">        FileName (str): Name of a file.</span>
  163 
  164 <span class="sd">    Returns:</span>
  165 <span class="sd">        bool : True, File contains title line; Otherwise, False.</span>
  166 
  167 <span class="sd">    &quot;&quot;&quot;</span>
  168     
  169     <span class="n">Infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
  170     <span class="k">if</span> <span class="n">Infile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  171         <span class="k">return</span> <span class="bp">False</span>
  172 
  173     <span class="n">Line</span> <span class="o">=</span> <span class="n">Infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
  174     <span class="n">Infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  175 
  176     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;(SMILES|Name|ID)&quot;</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  177         <span class="k">return</span> <span class="bp">True</span>
  178         
  179     <span class="k">return</span> <span class="bp">False</span>
  180     
  181 <span class="k">def</span> <span class="nf">ExpandFileNames</span><span class="p">(</span><span class="n">FilesSpec</span><span class="p">,</span> <span class="n">Delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">):</span>
  182     <span class="sd">&quot;&quot;&quot;Expand files specification using glob module to process any * or ? wild</span>
  183 <span class="sd">    cards in file names and return a list of expanded file names.</span>
  184 
  185 <span class="sd">    Arguments:</span>
  186 <span class="sd">        FilesSpec (str): Files specifications</span>
  187 <span class="sd">        Delimiter (str): Delimiter for file specifications</span>
  188 
  189 <span class="sd">    Returns:</span>
  190 <span class="sd">        list : List of expanded file names</span>
  191 
  192 <span class="sd">    &quot;&quot;&quot;</span>
  193     <span class="n">FileNames</span> <span class="o">=</span> <span class="p">[]</span>
  194     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">FilesSpec</span><span class="p">):</span>
  195         <span class="k">return</span> <span class="n">FileNames</span>
  196 
  197     <span class="k">for</span> <span class="n">FileSpec</span> <span class="ow">in</span> <span class="n">FilesSpec</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Delimiter</span><span class="p">):</span>
  198         <span class="n">FileSpec</span> <span class="o">=</span> <span class="n">FileSpec</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  199         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;(\*|\?)&quot;</span><span class="p">,</span> <span class="n">FileSpec</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  200             <span class="n">FileNames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">FileSpec</span><span class="p">))</span>
  201         <span class="k">else</span><span class="p">:</span>
  202             <span class="n">FileNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileSpec</span><span class="p">)</span>
  203     
  204     <span class="k">return</span> <span class="n">FileNames</span>
  205     
  206 <span class="k">def</span> <span class="nf">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">DocOptText</span><span class="p">):</span>
  207     <span class="sd">&quot;&quot;&quot;Get script usage example lines from a docopt doc string. The example text</span>
  208 <span class="sd">    line start from a line containing `Examples:`  keyword at the beginning of the line.</span>
  209 <span class="sd">    </span>
  210 <span class="sd">    Arguments:</span>
  211 <span class="sd">        DocOptText (str): Doc string containing script usage examples lines starting with</span>
  212 <span class="sd">            a line marked by `Examples:` keyword at the beginning of a line.</span>
  213 
  214 <span class="sd">    Returns:</span>
  215 <span class="sd">        str : A string containing text lines retrieved from the examples section of</span>
  216 <span class="sd">            DocOptText parameter.</span>
  217 
  218 <span class="sd">    &quot;&quot;&quot;</span>
  219     
  220     <span class="n">ExamplesStart</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^Examples:&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
  221     <span class="n">ExamplesEnd</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^(Author:|See also:|Copyright:)&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
  222     
  223     <span class="n">ExamplesText</span> <span class="o">=</span> <span class="s1">&#39;Examples text is not available&#39;</span>
  224     <span class="n">ExamplesTextFound</span> <span class="o">=</span> <span class="bp">False</span>
  225     
  226     <span class="k">for</span> <span class="n">Line</span> <span class="ow">in</span> <span class="n">DocOptText</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
  227         <span class="k">if</span> <span class="n">ExamplesStart</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>
  228             <span class="n">ExamplesText</span> <span class="o">=</span> <span class="s1">&#39;Examples:&#39;</span>
  229             <span class="n">ExamplesTextFound</span> <span class="o">=</span> <span class="bp">True</span>
  230             <span class="k">continue</span>
  231         
  232         <span class="k">if</span> <span class="n">ExamplesEnd</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">Line</span><span class="p">):</span>
  233             <span class="k">break</span>
  234         
  235         <span class="k">if</span> <span class="n">ExamplesTextFound</span><span class="p">:</span>
  236             <span class="n">ExamplesText</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">Line</span>
  237     
  238     <span class="k">return</span> <span class="n">ExamplesText</span>
  239 
  240 <span class="k">def</span> <span class="nf">GetExcelStyleColumnLabel</span><span class="p">(</span><span class="n">ColNum</span><span class="p">):</span>
  241     <span class="sd">&quot;&quot;&quot;Return Excel style column label for a colum number.</span>
  242 <span class="sd">    </span>
  243 <span class="sd">    Arguments:</span>
  244 <span class="sd">        ColNum (int): Column number</span>
  245 
  246 <span class="sd">    Returns:</span>
  247 <span class="sd">        str : Excel style column label.</span>
  248 
  249 <span class="sd">    &quot;&quot;&quot;</span>
  250     <span class="n">Letters</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
  251     
  252     <span class="n">ColLabelList</span> <span class="o">=</span> <span class="p">[]</span>
  253     <span class="k">while</span> <span class="n">ColNum</span><span class="p">:</span>
  254         <span class="n">ColNum</span><span class="p">,</span> <span class="n">SubColNum</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">ColNum</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>
  255         <span class="n">ColLabelList</span><span class="p">[:</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Letters</span><span class="p">[</span><span class="n">SubColNum</span><span class="p">]</span>
  256     
  257     <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ColLabelList</span><span class="p">)</span>
  258     
  259 <span class="k">def</span> <span class="nf">GetWallClockAndProcessorTime</span><span class="p">():</span>
  260     <span class="sd">&quot;&quot;&quot;Get wallclock and processor times in seconds.</span>
  261 <span class="sd">    </span>
  262 <span class="sd">    Returns:</span>
  263 <span class="sd">        float : Wallclock time.</span>
  264 <span class="sd">        float : Processor time.</span>
  265 
  266 <span class="sd">    &quot;&quot;&quot;</span>
  267     <span class="k">return</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span> <span class="n">_GetProcessorTime</span><span class="p">())</span>
  268 
  269 <span class="k">def</span> <span class="nf">_GetProcessorTime</span><span class="p">():</span>
  270     <span class="sd">&quot;&quot;&quot;Get processor time &quot;&quot;&quot;</span>
  271 
  272     <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
  273         <span class="n">ProcessorTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
  274     <span class="k">else</span><span class="p">:</span>
  275         <span class="n">ProcessorTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">clock</span><span class="p">()</span>
  276     
  277     <span class="k">return</span> <span class="n">ProcessorTime</span>
  278 
  279 <span class="k">def</span> <span class="nf">GetMayaChemToolsVersion</span><span class="p">():</span>
  280     <span class="sd">&quot;&quot;&quot;Get version number for MayaChemTools from PackageInfo.csv</span>
  281 <span class="sd">    file in MayaChemTool lib data directory.</span>
  282 <span class="sd">    </span>
  283 <span class="sd">    Returns:</span>
  284 <span class="sd">        str : Version number </span>
  285 
  286 <span class="sd">    &quot;&quot;&quot;</span>
  287     <span class="n">VersionNumber</span> <span class="o">=</span> <span class="s2">&quot;NA&quot;</span>
  288     
  289     <span class="n">PackageInfoFilePath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="s2">&quot;PackageInfo.csv&quot;</span><span class="p">)</span>
  290     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PackageInfoFilePath</span><span class="p">):</span>
  291         <span class="k">return</span> <span class="n">VersionNumber</span>
  292     
  293     <span class="n">Delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
  294     <span class="n">QuoteChar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
  295     <span class="n">IgnoreHeaderLine</span> <span class="o">=</span> <span class="bp">True</span>
  296     
  297     <span class="k">for</span> <span class="n">LineWords</span> <span class="ow">in</span> <span class="n">GetTextLinesWords</span><span class="p">(</span><span class="n">PackageInfoFilePath</span><span class="p">,</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">QuoteChar</span><span class="p">,</span> <span class="n">IgnoreHeaderLine</span><span class="p">):</span>
  298         <span class="n">KeyName</span><span class="p">,</span> <span class="n">KeyValue</span> <span class="o">=</span> <span class="n">LineWords</span>
  299         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^VersionNumber$&quot;</span><span class="p">,</span> <span class="n">KeyName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  300             <span class="n">VersionNumber</span> <span class="o">=</span> <span class="n">KeyValue</span>
  301             <span class="k">break</span>
  302     
  303     <span class="k">return</span> <span class="n">VersionNumber</span>
  304 
  305 <span class="k">def</span> <span class="nf">GetMayaChemToolsLibDataPath</span><span class="p">():</span>
  306     <span class="sd">&quot;&quot;&quot;Get location of MayaChemTools lib data directory.</span>
  307 <span class="sd">    </span>
  308 <span class="sd">    Returns:</span>
  309 <span class="sd">        str : Location of MayaChemTools lib data directory.</span>
  310 
  311 <span class="sd">    Notes:</span>
  312 <span class="sd">        The location of MayaChemTools lib data directory is determined relative to</span>
  313 <span class="sd">        MayaChemTools python lib directory name available through sys.path.</span>
  314 
  315 <span class="sd">    &quot;&quot;&quot;</span>
  316     <span class="n">MayaChemToolsDataPath</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  317 
  318     <span class="k">for</span> <span class="n">PathEntry</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
  319         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;MayaChemTools&quot;</span><span class="p">,</span> <span class="n">PathEntry</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;Python&quot;</span><span class="p">,</span> <span class="n">PathEntry</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  320             <span class="n">MayaChemToolsDataPath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PathEntry</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span>  <span class="s2">&quot;data&quot;</span><span class="p">)</span>
  321             <span class="k">break</span>
  322     
  323     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MayaChemToolsDataPath</span><span class="p">):</span>
  324         <span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;MayaChemTools lib directory location doesn&#39;t appear to exist in system search path specified by sys.path...&quot;</span><span class="p">)</span>
  325         
  326     <span class="k">return</span> <span class="n">MayaChemToolsDataPath</span>
  327     
  328 <span class="k">def</span> <span class="nf">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">StartingWallClockTime</span><span class="p">,</span> <span class="n">StartingProcessorTime</span><span class="p">):</span>
  329     <span class="sd">&quot;&quot;&quot;Get elapsed wallclock and processor times  as a string in the following</span>
  330 <span class="sd">    format: Wallclock: %s days, %d hrs, %d mins, %d secs (Process:  %d days,</span>
  331 <span class="sd">    %d hrs, %d mins, %.2f secs).</span>
  332 <span class="sd">    </span>
  333 <span class="sd">    Arguments:</span>
  334 <span class="sd">        StartingWallClockTime (float): Starting wallclock time in seconds.</span>
  335 <span class="sd">        StartingProcessorTime (float): Starting processor time in seconds.</span>
  336 
  337 <span class="sd">    Returns:</span>
  338 <span class="sd">        str : Elapsed time formatted as:</span>
  339 <span class="sd">            Wallclock: %s days, %d hrs, %d mins, %d secs (Process:  %d days,</span>
  340 <span class="sd">            %d hrs, %d mins, %.2f secs)</span>
  341 
  342 <span class="sd">    &quot;&quot;&quot;</span>
  343     
  344     <span class="n">ElapsedWallClockTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">StartingWallClockTime</span>
  345     <span class="n">ElapsedProcessorTime</span> <span class="o">=</span> <span class="n">_GetProcessorTime</span><span class="p">()</span> <span class="o">-</span> <span class="n">StartingProcessorTime</span>
  346 
  347     <span class="n">ElapsedTime</span> <span class="o">=</span> <span class="s2">&quot;Wallclock: </span><span class="si">%s</span><span class="s2"> (Process: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_FormatTimeInSecondsAsText</span><span class="p">(</span><span class="n">ElapsedWallClockTime</span><span class="p">),</span> <span class="n">_FormatTimeInSecondsAsText</span><span class="p">(</span><span class="n">ElapsedProcessorTime</span><span class="p">,</span> <span class="n">Precision</span> <span class="o">=</span> <span class="mi">2</span><span class="p">))</span>
  348     
  349     <span class="k">return</span> <span class="n">ElapsedTime</span>
  350 
  351 <span class="k">def</span> <span class="nf">_FormatTimeInSecondsAsText</span><span class="p">(</span><span class="n">Seconds</span><span class="p">,</span> <span class="n">Precision</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
  352     <span class="sd">&quot;&quot;&quot;Get time in seconds in the following format: days, hrs, mins, secs.&quot;&quot;&quot;</span>
  353 
  354     <span class="n">SecondsInDay</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span><span class="mi">60</span>
  355     <span class="n">SecondsInHour</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>
  356     <span class="n">SecondsInMinute</span> <span class="o">=</span> <span class="mi">60</span>
  357     
  358     <span class="n">Days</span> <span class="o">=</span> <span class="n">Seconds</span><span class="o">//</span><span class="n">SecondsInDay</span>
  359     <span class="n">Hours</span> <span class="o">=</span> <span class="p">(</span><span class="n">Seconds</span> <span class="o">-</span> <span class="n">Days</span><span class="o">*</span><span class="n">SecondsInDay</span><span class="p">)</span><span class="o">//</span><span class="n">SecondsInHour</span>
  360     <span class="n">Minutes</span> <span class="o">=</span> <span class="p">(</span><span class="n">Seconds</span> <span class="o">-</span> <span class="n">Days</span><span class="o">*</span><span class="n">SecondsInDay</span> <span class="o">-</span> <span class="n">Hours</span><span class="o">*</span><span class="n">SecondsInHour</span><span class="p">)</span><span class="o">//</span><span class="n">SecondsInMinute</span>
  361     <span class="n">Seconds</span> <span class="o">=</span> <span class="n">Seconds</span> <span class="o">-</span> <span class="n">Days</span><span class="o">*</span><span class="n">SecondsInDay</span> <span class="o">-</span> <span class="n">Hours</span><span class="o">*</span><span class="n">SecondsInHour</span> <span class="o">-</span> <span class="n">Minutes</span><span class="o">*</span><span class="n">SecondsInMinute</span>
  362 
  363     <span class="n">TimeWords</span> <span class="o">=</span> <span class="p">[]</span>
  364     
  365     <span class="k">if</span> <span class="n">Days</span><span class="p">:</span>
  366         <span class="n">TimeWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> day</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Days</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">Days</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
  367     
  368     <span class="k">if</span> <span class="n">Days</span> <span class="ow">or</span> <span class="n">Hours</span><span class="p">:</span>
  369         <span class="n">TimeWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> hr</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Hours</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">Hours</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
  370     
  371     <span class="k">if</span> <span class="n">Days</span> <span class="ow">or</span> <span class="n">Hours</span> <span class="ow">or</span> <span class="n">Minutes</span><span class="p">:</span>
  372         <span class="n">TimeWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> min</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Minutes</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="n">Minutes</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
  373 
  374     <span class="n">Seconds</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.*f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Precision</span><span class="p">,</span> <span class="n">Seconds</span><span class="p">)</span>
  375     <span class="n">TimeWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> sec</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Seconds</span><span class="p">,</span> <span class="s2">&quot;s&quot;</span> <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">Seconds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
  376     
  377     <span class="k">return</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">TimeWords</span><span class="p">)</span>
  378 
  379 <span class="k">def</span> <span class="nf">GetFormattedFileSize</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="n">Precision</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
  380     <span class="sd">&quot;&quot;&quot;Get file size  as a string in the following format: %.*f &lt;bytes, KB, MB,</span>
  381 <span class="sd">    GB&gt;</span>
  382 <span class="sd">    </span>
  383 <span class="sd">    Arguments:</span>
  384 <span class="sd">        FileName (str): File path.</span>
  385 <span class="sd">        Precision (int): File size precision.</span>
  386 
  387 <span class="sd">    Returns:</span>
  388 <span class="sd">        str : File size formatted as: %.2f &lt;bytes, KB, MB, GB&gt;</span>
  389 
  390 <span class="sd">    &quot;&quot;&quot;</span>
  391     
  392     <span class="n">Size</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">FileName</span><span class="p">)</span>
  393 
  394     <span class="k">if</span> <span class="n">Size</span> <span class="o">&lt;</span> <span class="mi">1024</span><span class="p">:</span>
  395         <span class="n">SizeDenominator</span> <span class="o">=</span> <span class="mi">1</span>
  396         <span class="n">SizeSuffix</span> <span class="o">=</span> <span class="s2">&quot;bytes&quot;</span>
  397     <span class="k">elif</span> <span class="n">Size</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">):</span>
  398         <span class="n">SizeDenominator</span> <span class="o">=</span> <span class="mi">1024</span>
  399         <span class="n">SizeSuffix</span> <span class="o">=</span> <span class="s2">&quot;KB&quot;</span>
  400     <span class="k">elif</span> <span class="n">Size</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">):</span>
  401         <span class="n">SizeDenominator</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span>
  402         <span class="n">SizeSuffix</span> <span class="o">=</span> <span class="s2">&quot;MB&quot;</span>
  403     <span class="k">elif</span> <span class="n">Size</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">):</span>
  404         <span class="n">SizeDenominator</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span>
  405         <span class="n">SizeSuffix</span> <span class="o">=</span> <span class="s2">&quot;GB&quot;</span>
  406     <span class="k">else</span><span class="p">:</span>
  407         <span class="n">SizeDenominator</span> <span class="o">=</span> <span class="mi">1</span>
  408         <span class="n">SizeSuffix</span> <span class="o">=</span> <span class="s2">&quot;bytes&quot;</span>
  409         
  410     <span class="n">Size</span> <span class="o">/=</span> <span class="n">SizeDenominator</span>
  411 
  412     <span class="n">FormattedSize</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.*f</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Precision</span><span class="p">,</span> <span class="n">Size</span><span class="p">,</span> <span class="n">SizeSuffix</span><span class="p">)</span>
  413     
  414     <span class="k">return</span> <span class="n">FormattedSize</span>
  415         
  416 <span class="k">def</span> <span class="nf">IsEmpty</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  417     <span class="sd">&quot;&quot;&quot;Determine whether the specified value is empty after converting</span>
  418 <span class="sd">    it in to a string and removing all leading and trailing white spaces. A  value</span>
  419 <span class="sd">    of type None is considered empty.</span>
  420 <span class="sd">    </span>
  421 <span class="sd">    Arguments:</span>
  422 <span class="sd">        Value (str, int or float): Text or a value</span>
  423 
  424 <span class="sd">    Returns:</span>
  425 <span class="sd">        bool : True, Text string is empty; Otherwsie, False.</span>
  426 
  427 <span class="sd">    &quot;&quot;&quot;</span>
  428 
  429     <span class="k">if</span> <span class="n">Value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  430         <span class="k">return</span> <span class="bp">True</span>
  431 
  432     <span class="n">TextValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Value</span>
  433     <span class="n">TextValue</span> <span class="o">=</span> <span class="n">TextValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  434 
  435     <span class="k">return</span> <span class="bp">False</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">TextValue</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
  436 
  437 <span class="k">def</span> <span class="nf">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  438     <span class="sd">&quot;&quot;&quot;Determine whether the specified value is a float by converting it</span>
  439 <span class="sd">    into a float.</span>
  440 <span class="sd">    </span>
  441 <span class="sd">    Arguments:</span>
  442 <span class="sd">        Value (str, int or float): Text</span>
  443 
  444 <span class="sd">    Returns:</span>
  445 <span class="sd">        bool : True, Value is a float; Otherwsie, False.</span>
  446 
  447 <span class="sd">    &quot;&quot;&quot;</span>
  448 
  449     <span class="k">return</span> <span class="n">IsNumber</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  450 
  451 <span class="k">def</span> <span class="nf">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  452     <span class="sd">&quot;&quot;&quot;Determine whether the specified value is an integer by converting it</span>
  453 <span class="sd">    into an int.</span>
  454 <span class="sd">    </span>
  455 <span class="sd">    Arguments:</span>
  456 <span class="sd">        Value (str, int or float): Text</span>
  457 
  458 <span class="sd">    Returns:</span>
  459 <span class="sd">        bool : True, Value is an integer; Otherwsie, False.</span>
  460 
  461 <span class="sd">    &quot;&quot;&quot;</span>
  462 
  463     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span>
  464     
  465     <span class="k">if</span> <span class="n">Value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  466         <span class="k">return</span> <span class="bp">False</span>
  467 
  468     <span class="k">try</span><span class="p">:</span>
  469         <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  470         <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span>
  471     <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
  472         <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  473     
  474     <span class="k">return</span> <span class="n">Status</span>
  475 
  476 <span class="k">def</span> <span class="nf">IsNumber</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  477     <span class="sd">&quot;&quot;&quot;Determine whether the specified value is a number by converting it</span>
  478 <span class="sd">    into a float.</span>
  479 <span class="sd">    </span>
  480 <span class="sd">    Arguments:</span>
  481 <span class="sd">        Value (str, int or float): Text</span>
  482 
  483 <span class="sd">    Returns:</span>
  484 <span class="sd">        bool : True, Value is a number; Otherwsie, False.</span>
  485 
  486 <span class="sd">    &quot;&quot;&quot;</span>
  487 
  488     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span>
  489     
  490     <span class="k">if</span> <span class="n">Value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  491         <span class="k">return</span> <span class="n">Status</span>
  492 
  493     <span class="k">try</span><span class="p">:</span>
  494         <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  495         <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span>
  496     <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
  497         <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  498     
  499     <span class="k">return</span> <span class="n">Status</span>
  500 
  501 <span class="k">def</span> <span class="nf">JoinWords</span><span class="p">(</span><span class="n">Words</span><span class="p">,</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">Quote</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
  502     <span class="sd">&quot;&quot;&quot;Join words in a list using specified delimiter with optional quotes around words.</span>
  503 <span class="sd">    </span>
  504 <span class="sd">    Arguments:</span>
  505 <span class="sd">        Words (list): List containing words to join.</span>
  506 <span class="sd">        Delimiter (string): Delimiter for joining words.</span>
  507 <span class="sd">        Quote (boolean): Put quotes around words.</span>
  508 
  509 <span class="sd">    Returns:</span>
  510 <span class="sd">        str : String containing joined words.</span>
  511 
  512 <span class="sd">    &quot;&quot;&quot;</span>
  513     
  514     <span class="k">if</span> <span class="n">Quote</span><span class="p">:</span>
  515         <span class="n">JoinedWords</span> <span class="o">=</span> <span class="n">Delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;&quot;{0}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Word</span><span class="p">)</span> <span class="k">for</span> <span class="n">Word</span> <span class="ow">in</span> <span class="n">Words</span><span class="p">)</span>
  516     <span class="k">else</span><span class="p">:</span>
  517         <span class="n">JoinedWords</span> <span class="o">=</span> <span class="n">Delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Words</span><span class="p">)</span>
  518         
  519     <span class="k">return</span> <span class="n">JoinedWords</span>
  520     
  521 <span class="k">def</span> <span class="nf">ObjectToBase64EncodedString</span><span class="p">(</span><span class="n">Object</span><span class="p">):</span>
  522     <span class="sd">&quot;&quot;&quot;Encode Python object into base64 encoded string. The object is</span>
  523 <span class="sd">    pickled before encoding.</span>
  524 <span class="sd">    </span>
  525 <span class="sd">    Arguments:</span>
  526 <span class="sd">        object: Python object.</span>
  527 
  528 <span class="sd">    Returns:</span>
  529 <span class="sd">        str : Base64 encode object string or None.</span>
  530 
  531 <span class="sd">    &quot;&quot;&quot;</span>
  532 
  533     <span class="k">return</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">Object</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">Object</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
  534 
  535 <span class="k">def</span> <span class="nf">ObjectFromBase64EncodedString</span><span class="p">(</span><span class="n">EncodedObject</span><span class="p">):</span>
  536     <span class="sd">&quot;&quot;&quot;Generate Python object from a bas64 encoded and pickled</span>
  537 <span class="sd">    object string.</span>
  538 <span class="sd">    </span>
  539 <span class="sd">    Arguments:</span>
  540 <span class="sd">        str: Base64 encoded and pickled object string.</span>
  541 
  542 <span class="sd">    Returns:</span>
  543 <span class="sd">        object : Python object or None.</span>
  544 
  545 <span class="sd">    &quot;&quot;&quot;</span>
  546 
  547     <span class="k">return</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">EncodedObject</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">EncodedObject</span><span class="p">))</span>
  548 
  549 <span class="k">def</span> <span class="nf">ParseFileName</span><span class="p">(</span><span class="n">FilePath</span><span class="p">):</span>
  550     <span class="sd">&quot;&quot;&quot;Parse specified file path and return file dir, file name, and file extension.</span>
  551 <span class="sd">    </span>
  552 <span class="sd">    Arguments:</span>
  553 <span class="sd">        FilePath (str): Name of a file with complete file path.</span>
  554 
  555 <span class="sd">    Returns:</span>
  556 <span class="sd">        str : File directory.</span>
  557 <span class="sd">        str : File name without file extension.</span>
  558 <span class="sd">        str : File extension.</span>
  559 
  560 <span class="sd">    &quot;&quot;&quot;</span>
  561     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileBaseName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">FilePath</span><span class="p">)</span>
  562     <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">FileBaseName</span><span class="p">)</span>
  563     
  564     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^\.&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">):</span>
  565         <span class="n">FileExt</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;^\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">)</span>
  566         
  567     <span class="k">return</span> <span class="p">(</span><span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">)</span>
  568     
  569 <span class="k">def</span> <span class="nf">PrintError</span><span class="p">(</span><span class="n">Msg</span><span class="p">,</span> <span class="n">Status</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
  570     <span class="sd">&quot;&quot;&quot;Print message to stderr along with flushing stderr and exit with a specified</span>
  571 <span class="sd">    status. An `Error` prefix is placed before the message.</span>
  572 <span class="sd">    </span>
  573 <span class="sd">    Arguments:</span>
  574 <span class="sd">        Msg (str): Text message.</span>
  575 <span class="sd">        Status (int): Exit status.</span>
  576 
  577 <span class="sd">    &quot;&quot;&quot;</span>
  578     
  579     <span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Error: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Msg</span><span class="p">)</span>
  580     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">Status</span><span class="p">)</span>
  581 
  582 <span class="k">def</span> <span class="nf">PrintInfo</span><span class="p">(</span><span class="n">Msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
  583     <span class="sd">&quot;&quot;&quot;Print message to stderr along with flushing stderr.</span>
  584 <span class="sd">    </span>
  585 <span class="sd">    Arguments:</span>
  586 <span class="sd">        Msg (str): Text message.</span>
  587 
  588 <span class="sd">    &quot;&quot;&quot;</span>
  589     
  590     <span class="k">print</span><span class="p">(</span><span class="n">Msg</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
  591     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
  592 
  593 <span class="k">def</span> <span class="nf">PrintWarning</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
  594     <span class="sd">&quot;&quot;&quot;Print message to stderr along with flushing stderr. An `Warning` prefix</span>
  595 <span class="sd">    is placed before the message.</span>
  596 <span class="sd">    </span>
  597 <span class="sd">    Arguments:</span>
  598 <span class="sd">        Msg (str): Text message.</span>
  599 
  600 <span class="sd">    &quot;&quot;&quot;</span>
  601     
  602     <span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Warning: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">)</span>
  603 
  604 <span class="k">def</span> <span class="nf">ValidateOptionFileExt</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExts</span><span class="p">):</span>
  605     <span class="sd">&quot;&quot;&quot;Validate file type based on the specified file extensions delimited by spaces.</span>
  606 <span class="sd">    </span>
  607 <span class="sd">    Arguments:</span>
  608 <span class="sd">        OptionName (str): Command line option name.</span>
  609 <span class="sd">        FileName (str): Name of a file.</span>
  610 <span class="sd">        FileExts (str): Space delimited string containing valid file extensions.</span>
  611 
  612 <span class="sd">    Notes:</span>
  613 <span class="sd">        The function exits with an error message for a file name containing</span>
  614 <span class="sd">        invalid file extension.</span>
  615 
  616 <span class="sd">    &quot;&quot;&quot;</span>
  617     
  618     <span class="k">if</span> <span class="ow">not</span> <span class="n">CheckFileExt</span><span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="n">FileExts</span><span class="p">):</span>
  619         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file name specified , </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not valid. Supported file formats: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">FileExts</span><span class="p">))</span>
  620 
  621 <span class="k">def</span> <span class="nf">ValidateOptionFilePath</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">FilePath</span><span class="p">):</span>
  622     <span class="sd">&quot;&quot;&quot;Validate presence of the file.</span>
  623 <span class="sd">    </span>
  624 <span class="sd">    Arguments:</span>
  625 <span class="sd">        OptionName (str): Command line option name.</span>
  626 <span class="sd">        FilePath (str): Name of a file with complete path.</span>
  627 
  628 <span class="sd">    Notes:</span>
  629 <span class="sd">        The function exits with an error message for a file path that doesn&#39;t exist.</span>
  630 
  631 <span class="sd">    &quot;&quot;&quot;</span>
  632     
  633     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FilePath</span><span class="p">):</span>
  634         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t exist.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FilePath</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  635 
  636 <span class="k">def</span> <span class="nf">ValidateOptionFloatValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValue</span><span class="p">,</span> <span class="n">CmpOpValueMap</span><span class="p">):</span>
  637     <span class="sd">&quot;&quot;&quot;Validate option value using comparison operater and value pairs in specified in</span>
  638 <span class="sd">    a map.</span>
  639 <span class="sd">    </span>
  640 <span class="sd">    Arguments:</span>
  641 <span class="sd">        OptionName (str): Command line option name.</span>
  642 <span class="sd">        OptionValue (float or str): Command line option value.</span>
  643 <span class="sd">        CmpOpValueMap (dictionary): Comparison operator key and value pairs to</span>
  644 <span class="sd">            validate values specified in OptionValue.</span>
  645 
  646 <span class="sd">    Notes:</span>
  647 <span class="sd">        The function exits with an error message for an invalid option values specified</span>
  648 <span class="sd">        in OptionValue.</span>
  649 
  650 <span class="sd">    Examples:</span>
  651 
  652 <span class="sd">        ValidateOptionNumberValue(&quot;-b, --butinaSimilarityCutoff&quot;, </span>
  653 <span class="sd">            Options[&quot;--butinaSimilarityCutoff&quot;],</span>
  654 <span class="sd">            {&quot;&gt;&quot;: 0.0, &quot;&lt;=&quot; : 1.0})</span>
  655 
  656 <span class="sd">    &quot;&quot;&quot;</span>
  657 
  658     <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">OptionValue</span><span class="p">):</span>
  659         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValue</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  660     
  661     <span class="k">return</span> <span class="n">ValidateOptionNumberValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">OptionValue</span><span class="p">),</span> <span class="n">CmpOpValueMap</span><span class="p">)</span>
  662 
  663 <span class="k">def</span> <span class="nf">ValidateOptionIntegerValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValue</span><span class="p">,</span> <span class="n">CmpOpValueMap</span><span class="p">):</span>
  664     <span class="sd">&quot;&quot;&quot;Validate option value using comparison operater and value pairs in specified in</span>
  665 <span class="sd">    a map.</span>
  666 <span class="sd">    </span>
  667 <span class="sd">    Arguments:</span>
  668 <span class="sd">        OptionName (str): Command line option name.</span>
  669 <span class="sd">        OptionValue (int or str): Command line option value.</span>
  670 <span class="sd">        CmpOpValueMap (dictionary): Comparison operator key and value pairs to</span>
  671 <span class="sd">            validate values specified in OptionValue.</span>
  672 
  673 <span class="sd">    Notes:</span>
  674 <span class="sd">        The function exits with an error message for an invalid option values specified</span>
  675 <span class="sd">        in OptionValue.</span>
  676 
  677 <span class="sd">    Examples:</span>
  678 
  679 <span class="sd">        ValidateOptionIntegerValue(&quot;--maxConfs&quot;, Options[&quot;--maxConfs&quot;],</span>
  680 <span class="sd">            {&quot;&gt;&quot;: 0})</span>
  681 
  682 <span class="sd">    &quot;&quot;&quot;</span>
  683 
  684     <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">OptionValue</span><span class="p">):</span>
  685         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValue</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  686     
  687     <span class="k">return</span> <span class="n">ValidateOptionNumberValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">OptionValue</span><span class="p">),</span> <span class="n">CmpOpValueMap</span><span class="p">)</span>
  688 
  689 <span class="k">def</span> <span class="nf">ValidateOptionNumberValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValue</span><span class="p">,</span> <span class="n">CmpOpValueMap</span><span class="p">):</span>
  690     <span class="sd">&quot;&quot;&quot;Validate option value using comparison operater and value pairs in specified in</span>
  691 <span class="sd">    a map.</span>
  692 <span class="sd">    </span>
  693 <span class="sd">    Arguments:</span>
  694 <span class="sd">        OptionName (str): Command line option name.</span>
  695 <span class="sd">        OptionValue (int or float): Command line option value.</span>
  696 <span class="sd">        CmpOpValueMap (dictionary): Comparison operator key and value pairs to</span>
  697 <span class="sd">            validate values specified in OptionValue.</span>
  698 
  699 <span class="sd">    Notes:</span>
  700 <span class="sd">        The function exits with an error message for an invalid option values specified</span>
  701 <span class="sd">        in OptionValue.</span>
  702 
  703 <span class="sd">    Examples:</span>
  704 
  705 <span class="sd">        ValidateOptionNumberValue(&quot;--maxConfs&quot;, int(Options[&quot;--maxConfs&quot;]),</span>
  706 <span class="sd">            {&quot;&gt;&quot;: 0})</span>
  707 <span class="sd">        ValidateOptionNumberValue(&quot;-b, --butinaSimilarityCutoff&quot;, </span>
  708 <span class="sd">            float(Options[&quot;--butinaSimilarityCutoff&quot;]),</span>
  709 <span class="sd">            {&quot;&gt;&quot;: 0.0, &quot;&lt;=&quot; : 1.0})</span>
  710 
  711 <span class="sd">    &quot;&quot;&quot;</span>
  712     
  713     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span>
  714     <span class="k">for</span> <span class="n">CmpOp</span> <span class="ow">in</span> <span class="n">CmpOpValueMap</span><span class="p">:</span>
  715         <span class="n">Value</span> <span class="o">=</span> <span class="n">CmpOpValueMap</span><span class="p">[</span><span class="n">CmpOp</span><span class="p">]</span>
  716         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&gt;$&quot;</span><span class="p">,</span> <span class="n">CmpOp</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  717             <span class="k">if</span> <span class="n">OptionValue</span> <span class="o">&lt;=</span> <span class="n">Value</span><span class="p">:</span>
  718                 <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  719                 <span class="k">break</span>
  720         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&gt;=$&quot;</span><span class="p">,</span> <span class="n">CmpOp</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  721             <span class="k">if</span> <span class="n">OptionValue</span> <span class="o">&lt;</span> <span class="n">Value</span><span class="p">:</span>
  722                 <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  723                 <span class="k">break</span>
  724         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&lt;$&quot;</span><span class="p">,</span> <span class="n">CmpOp</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  725             <span class="k">if</span> <span class="n">OptionValue</span> <span class="o">&gt;=</span> <span class="n">Value</span><span class="p">:</span>
  726                 <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  727                 <span class="k">break</span>
  728         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&lt;=$&quot;</span><span class="p">,</span> <span class="n">CmpOp</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  729             <span class="k">if</span> <span class="n">OptionValue</span> <span class="o">&gt;</span> <span class="n">Value</span><span class="p">:</span>
  730                 <span class="n">Status</span> <span class="o">=</span> <span class="bp">False</span>
  731                 <span class="k">break</span>
  732         <span class="k">else</span><span class="p">:</span>
  733             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The specified comparison operator, </span><span class="si">%s</span><span class="s2">, for function ValidateOptionNumberValue is not supported</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CmpOp</span><span class="p">))</span>
  734     
  735     <span class="k">if</span> <span class="ow">not</span> <span class="n">Status</span><span class="p">:</span>
  736         <span class="n">FirstValue</span> <span class="o">=</span> <span class="bp">True</span>
  737         <span class="n">SupportedValues</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  738         <span class="k">for</span> <span class="n">CmpOp</span> <span class="ow">in</span> <span class="n">CmpOpValueMap</span><span class="p">:</span>
  739             <span class="n">Value</span> <span class="o">=</span> <span class="n">CmpOpValueMap</span><span class="p">[</span><span class="n">CmpOp</span><span class="p">]</span>
  740             <span class="k">if</span> <span class="n">FirstValue</span><span class="p">:</span>
  741                 <span class="n">FirstValue</span> <span class="o">=</span> <span class="bp">False</span>
  742                 <span class="n">SupportedValues</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CmpOp</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span>
  743             <span class="k">else</span><span class="p">:</span>
  744                 <span class="n">SupportedValues</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SupportedValues</span><span class="p">,</span> <span class="n">CmpOp</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span>
  745         
  746         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not valid. Supported value(s): </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValue</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">SupportedValues</span><span class="p">))</span>
  747 
  748 <span class="k">def</span> <span class="nf">ValidateOptionNumberValues</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValueString</span><span class="p">,</span> <span class="n">OptionValueCount</span><span class="p">,</span> <span class="n">OptionValueDelimiter</span><span class="p">,</span> <span class="n">OptionValueType</span><span class="p">,</span> <span class="n">CmpOpValueMap</span><span class="p">):</span>
  749     <span class="sd">&quot;&quot;&quot;Validate numerical option values using option value string, delimiter, value type,</span>
  750 <span class="sd">    and a specified map containing comparison operator and value pairs.</span>
  751 <span class="sd">    </span>
  752 <span class="sd">    Arguments:</span>
  753 <span class="sd">        OptionName (str): Command line option name.</span>
  754 <span class="sd">        OptionValueString (str): Command line option value.</span>
  755 <span class="sd">        OptionValueCount (int): Number of values in OptionValueString.</span>
  756 <span class="sd">        OptionValueDelimiter (str): Delimiter used for values in OptionValueString.</span>
  757 <span class="sd">        OptionValueType (str): Valid number types (integer or float)</span>
  758 <span class="sd">        CmpOpValueMap (dictionary): Comparison operator key and value pairs to</span>
  759 <span class="sd">            validate values specified in OptionValueString.</span>
  760 
  761 <span class="sd">    Notes:</span>
  762 <span class="sd">        The function exits with an error message for invalid option values specified</span>
  763 <span class="sd">        in OptionValueString</span>
  764 
  765 <span class="sd">    Examples:</span>
  766 
  767 <span class="sd">        ValidateOptionNumberValues(&quot;-m, --molImageSize&quot;,</span>
  768 <span class="sd">            Options[&quot;--molImageSize&quot;], 2, &quot;,&quot;, &quot;integer&quot;, {&quot;&gt;&quot;: 0})</span>
  769 
  770 <span class="sd">    &quot;&quot;&quot;</span>
  771     <span class="k">if</span> <span class="ow">not</span> <span class="n">CheckTextValue</span><span class="p">(</span><span class="n">OptionValueType</span><span class="p">,</span> <span class="s2">&quot;integer float&quot;</span><span class="p">):</span>
  772         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The option value type specified, </span><span class="si">%s</span><span class="s2">, for function ValidateOptionNumberValues  is not valid. Supported value: integer float &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValueType</span><span class="p">))</span>
  773         
  774     <span class="n">Values</span> <span class="o">=</span> <span class="n">OptionValueString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">OptionValueDelimiter</span><span class="p">)</span>
  775     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Values</span><span class="p">)</span> <span class="o">!=</span> <span class="n">OptionValueCount</span><span class="p">:</span>
  776         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not valid. It must contain </span><span class="si">%d</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> values separated by </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValueString</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValueCount</span><span class="p">,</span> <span class="n">OptionValueType</span><span class="p">,</span> <span class="n">OptionValueDelimiter</span><span class="p">))</span>
  777 
  778     <span class="n">IsIntergerValue</span> <span class="o">=</span> <span class="bp">True</span>
  779     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^float$&quot;</span><span class="p">,</span> <span class="n">OptionValueType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  780         <span class="n">IsIntergerValue</span> <span class="o">=</span> <span class="bp">False</span>
  781     
  782     <span class="k">for</span> <span class="n">Value</span> <span class="ow">in</span> <span class="n">Values</span><span class="p">:</span>
  783         <span class="k">if</span> <span class="n">IsIntergerValue</span><span class="p">:</span>
  784             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  785                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> in string </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValueString</span><span class="p">))</span>
  786             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  787         <span class="k">else</span><span class="p">:</span>
  788             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  789                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> in string </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValueString</span><span class="p">))</span>
  790             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  791         <span class="n">ValidateOptionNumberValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">CmpOpValueMap</span><span class="p">)</span>
  792     
  793 <span class="k">def</span> <span class="nf">ValidateOptionTextValue</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">OptionValue</span><span class="p">,</span> <span class="n">ValidValues</span><span class="p">):</span>
  794     <span class="sd">&quot;&quot;&quot;Validate option value based on the valid specified values separated by spaces.</span>
  795 <span class="sd">    </span>
  796 <span class="sd">    Arguments:</span>
  797 <span class="sd">        OptionName (str): Command line option name.</span>
  798 <span class="sd">        OptionValue (str): Command line option value.</span>
  799 <span class="sd">        ValidValues (str): Space delimited string containing valid values.</span>
  800 
  801 <span class="sd">    Notes:</span>
  802 <span class="sd">        The function exits with an error message for an invalid option value.</span>
  803 
  804 <span class="sd">    &quot;&quot;&quot;</span>
  805     
  806     <span class="k">if</span> <span class="ow">not</span> <span class="n">CheckTextValue</span><span class="p">(</span><span class="n">OptionValue</span><span class="p">,</span> <span class="n">ValidValues</span><span class="p">):</span>
  807         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not valid. Supported value(s): </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionValue</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">ValidValues</span><span class="p">))</span>
  808 
  809 <span class="k">def</span> <span class="nf">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">FilePath</span><span class="p">,</span> <span class="n">OverwriteOptionName</span><span class="p">,</span> <span class="n">OverwriteStatus</span><span class="p">):</span>
  810     <span class="sd">&quot;&quot;&quot;Validate overwriting of output file.</span>
  811 <span class="sd">    </span>
  812 <span class="sd">    Arguments:</span>
  813 <span class="sd">        OptionName (str): Command line option name.</span>
  814 <span class="sd">        FilePath (str): Name of a file with complete file path.</span>
  815 <span class="sd">        OverwriteOptionName (str): Overwrite command line option name.</span>
  816 <span class="sd">        OverwriteStatus (bool): True, overwrite</span>
  817 
  818 <span class="sd">    Notes:</span>
  819 <span class="sd">        The function exits with an error message for a file that is present and is not allowed</span>
  820 <span class="sd">        to be written as indicated by value of OverwriteStatus.</span>
  821 
  822 <span class="sd">    &quot;&quot;&quot;</span>
  823     
  824     <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FilePath</span><span class="p">):</span>
  825         <span class="k">if</span> <span class="ow">not</span> <span class="n">OverwriteStatus</span><span class="p">:</span>
  826             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">OverwriteOptionName</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
  827                 <span class="n">ShortOverwriteOptionName</span> <span class="o">=</span> <span class="n">OverwriteOptionName</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
  828             <span class="k">else</span><span class="p">:</span>
  829                 <span class="n">ShortOverwriteOptionName</span> <span class="o">=</span> <span class="n">OverwriteOptionName</span>
  830             
  831             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> already exist. Use option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> and try again.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FilePath</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">,</span> <span class="n">ShortOverwriteOptionName</span><span class="p">,</span> <span class="n">OverwriteOptionName</span><span class="p">))</span>
  832 
  833 <span class="k">def</span> <span class="nf">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="n">OptionName1</span><span class="p">,</span> <span class="n">FilePath1</span><span class="p">,</span> <span class="n">OptionName2</span><span class="p">,</span> <span class="n">FilePath2</span><span class="p">):</span>
  834     <span class="sd">&quot;&quot;&quot;Validate two distinct file names.</span>
  835 
  836 <span class="sd">    Arguments:</span>
  837 <span class="sd">        OptionName1 (str): Command line option name.</span>
  838 <span class="sd">        FilePath1 (str): Name of a file with complete file path.</span>
  839 <span class="sd">        OptionName2 (str): Command line option name.</span>
  840 <span class="sd">        FilePath2 (str): Name of a file with complete file path.</span>
  841 
  842 <span class="sd">    Notes:</span>
  843 <span class="sd">        The function exits with an error message for two non distinct file names.</span>
  844 <span class="sd">    </span>
  845 <span class="sd">    &quot;&quot;&quot;</span>
  846     
  847     <span class="n">FilePath1Pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^&quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">FilePath1</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$&quot;</span>
  848     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">FilePath1Pattern</span><span class="p">,</span> <span class="n">FilePath2</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  849         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file name specified, </span><span class="si">%s</span><span class="s2">, for options </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> and </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be different.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FilePath1</span><span class="p">,</span> <span class="n">OptionName1</span><span class="p">,</span> <span class="n">OptionName2</span><span class="p">))</span>
  850 
  851 <span class="k">def</span> <span class="nf">ProcessOptionConformerParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  852     <span class="sd">&quot;&quot;&quot;Process parameters for conformer generation and return a map containing processed</span>
  853 <span class="sd">    parameter names and values.</span>
  854 <span class="sd">    </span>
  855 <span class="sd">    Arguments:</span>
  856 <span class="sd">        ParamsOptionName (str): Command line conformer generation parameters</span>
  857 <span class="sd">            option name.</span>
  858 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and value pairs.</span>
  859 <span class="sd">        ParamsDefaultInfo (dict): Default values to override for selected parameters.</span>
  860 
  861 <span class="sd">    Returns:</span>
  862 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
  863 
  864 <span class="sd">    Notes:</span>
  865 <span class="sd">        The parameter name and values specified in ParamsOptionValues are validated before</span>
  866 <span class="sd">        returning them in a dictionary.</span>
  867 
  868 <span class="sd">    &quot;&quot;&quot;</span>
  869 
  870     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ConfMethod&quot;</span><span class="p">:</span> <span class="s2">&quot;ETKDG&quot;</span><span class="p">,</span> <span class="s2">&quot;ForceField&quot;</span><span class="p">:</span> <span class="s2">&quot;MMFF&quot;</span><span class="p">,</span> <span class="s2">&quot;ForceFieldMMFFVariant&quot;</span><span class="p">:</span> <span class="s2">&quot;MMFF94&quot;</span><span class="p">,</span> <span class="s2">&quot;EnforceChirality&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;EmbedRMSDCutoff&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;AlignConformers&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;MaxConfs&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;MaxConfsTorsions&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;MaxIters&quot;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span> <span class="s2">&quot;RandomSeed&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;UseTethers&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
  871     
  872     <span class="c1"># Setup a canonical paramater names...</span>
  873     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
  874     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
  875     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">):</span>
  876         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
  877         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
  878     
  879     <span class="c1"># Update default values...</span>
  880     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  881         <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
  882             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
  883                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The default parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> to function ProcessOptionConformerParameters is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
  884             <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
  885     
  886     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  887         <span class="c1"># No specific parameters to process except for parameters with possible auto value...</span>
  888         <span class="n">_ProcessOptionConformerAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
  889         <span class="k">return</span> <span class="n">ParamsInfo</span>
  890     
  891     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  892     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
  893         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
  894     
  895     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  896     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
  897         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  898     
  899     <span class="c1"># Validate paramater name and value pairs...</span>
  900     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  901         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  902         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  903 
  904         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  905         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
  906             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
  907 
  908         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
  909         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  910         
  911         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ConfMethod$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  912             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(SDG|ETDG|KDG|ETKDG)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  913                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: SDG, ETDG, KDG or ETKDG&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  914             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  915         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ForceField$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  916             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(UFF|MMFF)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  917                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: UFF or MMFF&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  918             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  919         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ForceFieldMMFFVariant$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  920             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(MMFF94|MMFF94s)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  921                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: MMFF94 or MMFF94s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  922             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  923         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(EnforceChirality|AlignConformers|UseTethers)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  924             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(yes|true)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  925                 <span class="n">Value</span> <span class="o">=</span> <span class="bp">True</span>
  926             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(no|false)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  927                 <span class="n">Value</span> <span class="o">=</span> <span class="bp">False</span>
  928             <span class="k">else</span><span class="p">:</span>
  929                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: yes, no, true, or false&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  930             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  931         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(MaxConfs|MaxConfsTorsions|MaxIters)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  932             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  933                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  934             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  935             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
  936                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  937             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  938         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(EmbedRMSDCutoff)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  939             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(auto|none)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  940                 <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  941                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  942                 <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
  943                 <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
  944                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  945                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  946         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(RandomSeed)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  947             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  948                 <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
  949                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
  950                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  951         <span class="k">else</span><span class="p">:</span>
  952             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
  953         
  954         <span class="c1"># Set value...</span>
  955         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
  956     
  957     <span class="c1"># Handle paramaters with possible auto values...</span>
  958     <span class="n">_ProcessOptionConformerAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
  959 
  960     <span class="k">return</span> <span class="n">ParamsInfo</span>
  961 
  962 <span class="k">def</span> <span class="nf">_ProcessOptionConformerAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">):</span>
  963     <span class="sd">&quot;&quot;&quot;Process parameters with possible auto values.</span>
  964 <span class="sd">    &quot;&quot;&quot;</span>
  965 
  966     <span class="c1"># Random seed parameter...</span>
  967     <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;RandomSeed&quot;</span><span class="p">]</span>
  968     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  969         <span class="n">ParamValue</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
  970     <span class="k">else</span><span class="p">:</span>
  971         <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ParamValue</span><span class="p">)</span>
  972     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;RandomSeed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
  973     
  974     <span class="c1"># Random seed parameter...</span>
  975     <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;EmbedRMSDCutoff&quot;</span><span class="p">]</span>
  976     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(auto|none)$&quot;</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  977         <span class="n">ParamValue</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
  978     <span class="k">else</span><span class="p">:</span>
  979         <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ParamValue</span><span class="p">)</span>
  980     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;EmbedRMSDCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
  981 
  982     <span class="c1"># Setup derived parameters to facilitate conformer generations and minimization...</span>
  983     <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">False</span>
  984     <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">False</span>
  985     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ETDG$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ConfMethod&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  986         <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">True</span>
  987         <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">False</span>
  988     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^KDG$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ConfMethod&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  989         <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">False</span>
  990         <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">True</span>
  991     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ETKDG$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ConfMethod&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  992         <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">True</span>
  993         <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">True</span>
  994     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^SDG$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ConfMethod&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  995         <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">False</span>
  996         <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">False</span>
  997     <span class="k">else</span><span class="p">:</span>
  998         <span class="n">UseExpTorsionAnglePrefs</span> <span class="o">=</span> <span class="bp">None</span>
  999         <span class="n">UseBasicKnowledge</span> <span class="o">=</span> <span class="bp">None</span>
 1000     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;UseExpTorsionAnglePrefs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UseExpTorsionAnglePrefs</span>
 1001     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;UseBasicKnowledge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UseBasicKnowledge</span>
 1002     
 1003     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^UFF$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ForceField&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1004         <span class="n">UseUFF</span> <span class="o">=</span> <span class="bp">True</span>
 1005         <span class="n">UseMMFF</span> <span class="o">=</span> <span class="bp">False</span>
 1006     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^MMFF$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ForceField&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1007         <span class="n">UseUFF</span> <span class="o">=</span> <span class="bp">False</span>
 1008         <span class="n">UseMMFF</span> <span class="o">=</span> <span class="bp">True</span>
 1009     <span class="k">else</span><span class="p">:</span>
 1010         <span class="n">UseUFF</span> <span class="o">=</span> <span class="bp">None</span>
 1011         <span class="n">UseMMFF</span> <span class="o">=</span> <span class="bp">None</span>
 1012     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;UseUFF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UseExpTorsionAnglePrefs</span>
 1013     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;UseMMFF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UseBasicKnowledge</span>
 1014         
 1015 <span class="k">def</span> <span class="nf">ProcessOptionPyMOLCubeFileViewParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1016     <span class="sd">&quot;&quot;&quot;Process PyMOl parameters for cube file views and return a map containing</span>
 1017 <span class="sd">    processed parameter names and values.</span>
 1018 <span class="sd">    </span>
 1019 <span class="sd">    ParamsOptionValue is a comma delimited list of parameter name and value pairs</span>
 1020 <span class="sd">    for setting up PyMOL views.</span>
 1021 <span class="sd">    </span>
 1022 <span class="sd">    The supported parameter names along with their default and possible</span>
 1023 <span class="sd">    values are shown below:</span>
 1024 <span class="sd">    </span>
 1025 <span class="sd">        ContourColor1, red, ContourColor2, blue,</span>
 1026 <span class="sd">        ContourLevel1, -0.02, ContourLevel2, 0.02,</span>
 1027 <span class="sd">        ContourLevel, 0.02,</span>
 1028 <span class="sd">        ContourLevelAutoAt, 0.5,</span>
 1029 <span class="sd">        ESPRampValues, -1.0 0 1.0,</span>
 1030 <span class="sd">        ESPRampColors, red white blue,</span>
 1031 <span class="sd">        HideHydrogens, yes, DisplayESP, OnSurface,</span>
 1032 <span class="sd">        DisplayMolecule, BallAndStick,</span>
 1033 <span class="sd">        DisplaySphereScale, 0.3, DisplayStickRadius, 0.2,</span>
 1034 <span class="sd">        MeshQuality,2, MeshWidth, 0.5,</span>
 1035 <span class="sd">        SurfaceQualuty, 2, SurfaceTransparency, 0.25,</span>
 1036 <span class="sd">        VolumeColorRamp, auto, VolumeColorRampOpacity, 0.2,</span>
 1037 <span class="sd">        VolumeContourWindowFactor, 0.05</span>
 1038 <span class="sd">    </span>
 1039 <span class="sd">    Arguments:</span>
 1040 <span class="sd">        ParamsOptionName (str): Command line PyMOL view option name.</span>
 1041 <span class="sd">        ParamsOptionValues (str): Comma delimited list of parameter name and value pairs.</span>
 1042 <span class="sd">        ParamsDefaultInfo (dict): Default values to override for selected parameters.</span>
 1043 
 1044 <span class="sd">    Returns:</span>
 1045 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1046 
 1047 <span class="sd">    &quot;&quot;&quot;</span>
 1048 
 1049     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ContourColor1&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;ContourColor2&quot;</span><span class="p">:</span>  <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;ContourLevel1&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="s2">&quot;ContourLevel2&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s2">&quot;ContourLevel&quot;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s2">&quot;ContourLevelAutoAt&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;ESPRampValues&quot;</span><span class="p">:</span> <span class="s2">&quot;-1.0 0 1.0&quot;</span><span class="p">,</span> <span class="s2">&quot;ESPRampColors&quot;</span><span class="p">:</span> <span class="s2">&quot;red white blue&quot;</span><span class="p">,</span> <span class="s2">&quot;HideHydrogens&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;DisplayESP&quot;</span><span class="p">:</span> <span class="s2">&quot;OnSurface&quot;</span><span class="p">,</span> <span class="s2">&quot;DisplayMolecule&quot;</span><span class="p">:</span> <span class="s2">&quot;BallAndStick&quot;</span><span class="p">,</span> <span class="s2">&quot;DisplaySphereScale&quot;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;DisplayStickRadius&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;MeshQuality&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;MeshWidth&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;SurfaceQuality&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s2">&quot;VolumeColorRamp&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;VolumeColorRampOpacity&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;VolumeContourWindowFactor&quot;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
 1050     
 1051     <span class="c1"># Setup a canonical paramater names...</span>
 1052     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 1053     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1054     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">):</span>
 1055         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 1056         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 1057     
 1058     <span class="c1"># Update default values...</span>
 1059     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1060         <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1061             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
 1062                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The default parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> to function ProcessOptionPyMOLViewParametersForCubeFiles not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1063             <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1064     
 1065     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1066         <span class="c1"># No specific parameters to process except for parameters with possible auto value...</span>
 1067         <span class="n">_ProcessOptionPyMOLCubeFileViewAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1068         <span class="k">return</span> <span class="n">ParamsInfo</span>
 1069     
 1070     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1071     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
 1072         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
 1073     
 1074     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1075     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1076         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1077     
 1078     <span class="c1"># Validate paramater name and value pairs...</span>
 1079     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1080         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1081         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1082 
 1083         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1084         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 1085             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1086 
 1087         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 1088         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1089         <span class="n">ParamValueStr</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Value</span>
 1090         
 1091         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(MeshWidth|SurfaceTransparency|DisplaySphereScale|DisplayStickRadius)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1092             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1093                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1094             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1095             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1096                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1097             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1098         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(MeshQuality|SurfaceQuality)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1099             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1100                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1101             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1102             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1103                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1104             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1105         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ContourLevel1$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValueStr</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1106             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1107                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1108             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1109             <span class="k">if</span> <span class="n">Value</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
 1110                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &lt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1111             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1112         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ContourLevel2$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValueStr</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1113             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1114                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1115             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1116             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1117                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1118             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1119         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ContourLevel$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValueStr</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1120             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1121                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1122             <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1123         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ContourLevelAutoAt$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1124             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1125                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1126             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1127             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">Value</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
 1128                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0 and &lt; 1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1129             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1130         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^VolumeColorRampOpacity$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1131             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1132                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1133             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1134             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">Value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
 1135                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt;= 0 and &lt;= 1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1136             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1137         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^VolumeContourWindowFactor$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1138             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1139                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1140             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1141             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1142                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1143             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1144         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^HideHydrogens$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1145             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1146                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1147             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1148             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(No|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1149                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1150         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DisplayMolecule$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1151             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Sticks$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1152                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;Sticks&quot;</span>
 1153             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^BallAndStick$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1154                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;BallAndStick&quot;</span>
 1155             <span class="k">else</span><span class="p">:</span>
 1156                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Sticks or BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1157         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DisplayESP$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1158             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^OnTotalDensity$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1159                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;OnTotalDensity&quot;</span>
 1160             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^OnSurface$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1161                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;OnSurface&quot;</span>
 1162             <span class="k">else</span><span class="p">:</span>
 1163                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: OnTotalDensity or OnSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1164         <span class="k">else</span><span class="p">:</span>
 1165             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1166         
 1167         <span class="c1"># Set value...</span>
 1168         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1169 
 1170     <span class="c1"># Handle paramaters with possible auto values...</span>
 1171     <span class="n">_ProcessOptionPyMOLCubeFileViewAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1172 
 1173     <span class="k">return</span> <span class="n">ParamsInfo</span>
 1174 
 1175 <span class="k">def</span> <span class="nf">_ProcessOptionPyMOLCubeFileViewAutoParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">):</span>
 1176     <span class="sd">&quot;&quot;&quot;Process parameters with possible auto values.</span>
 1177 <span class="sd">    &quot;&quot;&quot;</span>
 1178 
 1179     <span class="c1"># Setup ParamsInfo to indicate &quot;auto&quot; values...</span>
 1180     <span class="n">ParamNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;VolumeColorRamp&quot;</span><span class="p">,</span> <span class="s2">&quot;ContourLevel1&quot;</span><span class="p">,</span> <span class="s2">&quot;ContourLevel2&quot;</span><span class="p">,</span> <span class="s2">&quot;ContourLevel&quot;</span><span class="p">,</span> <span class="s2">&quot;ESPRampColors&quot;</span><span class="p">,</span> <span class="s2">&quot;ESPRampValues&quot;</span><span class="p">]</span>
 1181     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamNames</span><span class="p">:</span>
 1182         <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1183         <span class="n">ParamValueAuto</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1184         <span class="n">ParamNameAuto</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Auto&quot;</span> <span class="o">%</span> <span class="n">ParamName</span>
 1185         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamNameAuto</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValueAuto</span>
 1186 
 1187 <span class="k">def</span> <span class="nf">ProcessOptionMultiprocessingParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">):</span>
 1188     <span class="sd">&quot;&quot;&quot;Process parameters for multiprocessing and return a map containing processed</span>
 1189 <span class="sd">    parameter names and values.</span>
 1190 <span class="sd">    </span>
 1191 <span class="sd">    Arguments:</span>
 1192 <span class="sd">        ParamsOptionName (str): Command line multiprocessing parameters option name.</span>
 1193 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and value pairs.</span>
 1194 
 1195 <span class="sd">    Returns:</span>
 1196 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1197 
 1198 <span class="sd">    Notes:</span>
 1199 <span class="sd">        The parameter name and values specified in ParamsOptionValue are validated before</span>
 1200 <span class="sd">        returning them in a dictionary.</span>
 1201 
 1202 <span class="sd">    &quot;&quot;&quot;</span>
 1203     
 1204     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ChunkSize&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;InputDataMode&#39;</span> <span class="p">:</span> <span class="s1">&#39;Lazy&#39;</span><span class="p">,</span> <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}</span>
 1205     
 1206     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1207         <span class="c1"># No specific parameters to process except for parameters with possible auto value...</span>
 1208         <span class="n">_ProcessOptionMultiprocessingParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1209         <span class="k">return</span> <span class="n">ParamsInfo</span>
 1210     
 1211     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1212     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
 1213         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
 1214     
 1215     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1216     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1217         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1218         
 1219     <span class="c1"># Setup a canonical paramater names...</span>
 1220     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 1221     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1222     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">):</span>
 1223         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 1224         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 1225     
 1226     <span class="c1"># Validate paramater name and value pairs...</span>
 1227     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1228         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1229         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
 1230 
 1231         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1232         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 1233             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1234 
 1235         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 1236         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1237         
 1238         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^InputDataMode$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1239             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Lazy$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1240                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;Lazy&quot;</span>
 1241             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^InMemory$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1242                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;InMemory&quot;</span>
 1243             <span class="k">else</span><span class="p">:</span>
 1244                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Lazy or InMemory&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1245         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^NumProcesses$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1246             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1247                 <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1248                 <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1249                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1250                 <span class="k">if</span> <span class="n">Value</span> <span class="o">&gt;</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
 1251                     <span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is greater than number of CPUs, </span><span class="si">%s</span><span class="s2">, returned by mp.cpu_count().&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
 1252         <span class="k">else</span><span class="p">:</span>
 1253             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1254                 <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1255                 <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1256                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1257         
 1258         <span class="c1"># Set value...</span>
 1259         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1260     
 1261     <span class="c1"># Handle paramaters with possible auto values...</span>
 1262     <span class="n">_ProcessOptionMultiprocessingParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1263     
 1264     <span class="k">return</span> <span class="n">ParamsInfo</span>
 1265 
 1266 <span class="k">def</span> <span class="nf">_ProcessOptionMultiprocessingParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">):</span>
 1267     <span class="sd">&quot;&quot;&quot;Process parameters with possible auto values.&quot;&quot;&quot;</span>
 1268 
 1269     <span class="c1"># NumProcesses parameter...</span>
 1270     <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;NumProcesses&quot;</span><span class="p">]</span>
 1271     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;NumProcesses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1272 
 1273     <span class="c1"># ChunkSize parameter...</span>
 1274     <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ChunkSize&quot;</span><span class="p">]</span>
 1275     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1276         <span class="n">Value</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^InMemory$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;InputDataMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="mi">1</span>
 1277     <span class="k">else</span><span class="p">:</span>
 1278         <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1279     <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;ChunkSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Value</span>
 1280     
 1281 <span class="k">def</span> <span class="nf">ProcessOptionInfileParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">OutfileName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1282     <span class="sd">&quot;&quot;&quot;Process parameters for reading input files and return a map containing</span>
 1283 <span class="sd">    processed parameter names and values.</span>
 1284 <span class="sd">    </span>
 1285 <span class="sd">    Arguments:</span>
 1286 <span class="sd">        ParamsOptionName (str): Command line input parameters option name.</span>
 1287 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and value pairs.</span>
 1288 <span class="sd">        InfileName (str): Name of input file.</span>
 1289 <span class="sd">        OutfileName (str): Name of output file.</span>
 1290 <span class="sd">        ParamsDefaultInfo (dict): Default values to override for selected parameters.</span>
 1291 
 1292 <span class="sd">    Returns:</span>
 1293 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1294 
 1295 <span class="sd">    Notes:</span>
 1296 <span class="sd">        The parameter name and values specified in ParamsOptionValue are validated before</span>
 1297 <span class="sd">        returning them in a dictionary.</span>
 1298 
 1299 <span class="sd">    &quot;&quot;&quot;</span>
 1300 
 1301     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;RemoveHydrogens&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;Sanitize&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;StrictParsing&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="s1">&#39;SMILESColumn&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;SMILESNameColumn&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;SMILESDelimiter&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;SMILESTitleLine&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">}</span>
 1302     
 1303     <span class="c1"># Update default values...</span>
 1304     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1305         <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1306             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
 1307                 <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
 1308                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The default parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> to function ProcessOptionInfileParameters is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1309             <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1310     
 1311     <span class="n">_ProcessInfileAndOutfileParameters</span><span class="p">(</span><span class="s1">&#39;Infile&#39;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">)</span>
 1312     
 1313     <span class="k">return</span> <span class="n">ParamsInfo</span>
 1314 
 1315 <span class="k">def</span> <span class="nf">ProcessOptionOutfileParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">OutfileName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1316     <span class="sd">&quot;&quot;&quot;Process parameters for writing output files and return a map containing</span>
 1317 <span class="sd">    processed parameter names and values.</span>
 1318 <span class="sd">    </span>
 1319 <span class="sd">    Arguments:</span>
 1320 <span class="sd">        ParamsOptionName (str): Command line input parameters option name.</span>
 1321 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and value pairs.</span>
 1322 <span class="sd">        InfileName (str): Name of input file.</span>
 1323 <span class="sd">        OutfileName (str): Name of output file.</span>
 1324 <span class="sd">        ParamsDefaultInfo (dict): Default values to override for selected parameters.</span>
 1325 
 1326 <span class="sd">    Returns:</span>
 1327 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1328 
 1329 <span class="sd">    Notes:</span>
 1330 <span class="sd">        The parameter name and values specified in ParamsOptionValue are validated before</span>
 1331 <span class="sd">        returning them in a dictionary.</span>
 1332 
 1333 <span class="sd">        The default value of some parameters may depend on type of input file. Consequently,</span>
 1334 <span class="sd">        the input file name is also needed.</span>
 1335 
 1336 <span class="sd">    &quot;&quot;&quot;</span>
 1337     
 1338     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Compute2DCoords&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;Kekulize&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;SMILESKekulize&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s1">&#39;SMILESDelimiter&#39;</span><span class="p">:</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;SMILESIsomeric&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>  <span class="s1">&#39;SMILESTitleLine&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;SMILESMolName&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s1">&#39;SMILESMolProps&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
 1339     
 1340     <span class="c1"># Update default values...</span>
 1341     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1342         <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1343             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
 1344                 <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
 1345                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The default parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> to function ProcessOptionOutfileParameters is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1346             <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1347     
 1348     <span class="n">_ProcessInfileAndOutfileParameters</span><span class="p">(</span><span class="s1">&#39;Outfile&#39;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">)</span>
 1349 
 1350     <span class="k">return</span> <span class="n">ParamsInfo</span>
 1351     
 1352 <span class="k">def</span> <span class="nf">_ProcessInfileAndOutfileParameters</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">):</span>
 1353     <span class="sd">&quot;&quot;&quot;Process specified infile and outfile paramaters.</span>
 1354 <span class="sd">    </span>
 1355 <span class="sd">    &quot;&quot;&quot;</span>
 1356     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1357         <span class="c1"># No specific parameters to process except for parameters with possible auto value...</span>
 1358         <span class="n">_ProcessInfileAndOutfileAutoParameters</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">)</span>
 1359         <span class="k">return</span>
 1360     
 1361     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">)</span>
 1362     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
 1363         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
 1364     
 1365     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1366     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1367         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1368         
 1369     <span class="c1"># Setup a canonical paramater names...</span>
 1370     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 1371     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1372     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">):</span>
 1373         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 1374         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 1375     
 1376     <span class="c1"># Validate paramater name and value pairs...</span>
 1377     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1378         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1379         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
 1380 
 1381         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1382         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 1383             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1384 
 1385         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 1386         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1387         
 1388         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Sanitize|StrictParsing|RemoveHydrogens|Kekulize|SMILESKekulize|SMILESIsomeric)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1389             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1390                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1391             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1392             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(No|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1393                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1394         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^SMILESTitleLine$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1395             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Infile$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1396                 <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False|Auto)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1397                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for paramater name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False Auto&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1398             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Outfile$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1399                 <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1400                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1401                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1402                 <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(No|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1403                     <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1404         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(SMILESMolName|SMILESMolProps)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1405             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Outfile$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1406                 <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1407                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1408                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1409                 <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(No|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1410                     <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1411             <span class="k">else</span><span class="p">:</span>
 1412                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value during mode </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">Mode</span><span class="p">))</span>
 1413         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^SMILESDelimiter$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1414             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(space|tab|comma)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1415                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: space tab comma&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1416             <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span>
 1417             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^tab$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1418                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
 1419             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^comma$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1420                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
 1421         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Compute2DCoords$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1422             <span class="c1"># No need to set the value. It would be processed later to handle &quot;auto&quot; value...</span>
 1423             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False|Auto)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1424                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for paramater name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: Yes No True False Auto&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1425         <span class="k">else</span><span class="p">:</span>
 1426             <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1427             <span class="k">if</span> <span class="n">ParamValue</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1428                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1429         
 1430         <span class="c1"># Set value...</span>
 1431         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1432         
 1433     <span class="c1"># Handle paramaters with possible auto values...</span>
 1434     <span class="n">_ProcessInfileAndOutfileAutoParameters</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">)</span>
 1435 
 1436 <span class="k">def</span> <span class="nf">_ProcessInfileAndOutfileAutoParameters</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">InfileName</span><span class="p">,</span> <span class="n">OutfileName</span><span class="p">):</span>
 1437     <span class="sd">&quot;&quot;&quot;Process parameters with possible auto values.</span>
 1438 <span class="sd">    </span>
 1439 <span class="sd">    &quot;&quot;&quot;</span>
 1440     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Infile$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1441         <span class="c1"># SMILESTitleLine parameter...</span>
 1442         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;SMILESTitleLine&quot;</span><span class="p">]</span>
 1443         <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1444         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1445             <span class="k">if</span> <span class="n">InfileName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1446                 <span class="k">if</span> <span class="n">CheckFileExt</span><span class="p">(</span><span class="n">InfileName</span><span class="p">,</span> <span class="s2">&quot;smi csv tsv txt&quot;</span><span class="p">):</span>
 1447                     <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">DoesSMILESFileContainTitleLine</span><span class="p">(</span><span class="n">InfileName</span><span class="p">)</span>
 1448         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|True)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1449             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1450         <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;SMILESTitleLine&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1451     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Outfile$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1452         <span class="c1"># Compute2DCoords parameter...</span>
 1453         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]</span>
 1454         <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1455         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1456             <span class="k">if</span> <span class="n">InfileName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1457                 <span class="k">if</span> <span class="n">CheckFileExt</span><span class="p">(</span><span class="n">InfileName</span><span class="p">,</span> <span class="s2">&quot;smi csv tsv txt&quot;</span><span class="p">):</span>
 1458                     <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1459             <span class="k">if</span> <span class="n">OutfileName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1460                 <span class="k">if</span> <span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OutfileName</span><span class="p">,</span> <span class="s2">&quot;smi csv tsv txt&quot;</span><span class="p">):</span>
 1461                     <span class="c1"># No need to compute 2D coords for SMILES file...</span>
 1462                     <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 1463         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|True)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1464             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 1465         <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1466 
 1467         <span class="c1"># SetSMILESMolProps parameter...</span>
 1468         <span class="n">SetSMILESMolProps</span> <span class="o">=</span> <span class="bp">False</span>
 1469         <span class="k">if</span> <span class="n">OutfileName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1470             <span class="n">SetSMILESMolProps</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;SMILESMolProps&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OutfileName</span><span class="p">,</span> <span class="s2">&quot;smi&quot;</span><span class="p">))</span> <span class="k">else</span> <span class="bp">False</span>
 1471         <span class="n">ParamsInfo</span><span class="p">[</span><span class="s2">&quot;SetSMILESMolProps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SetSMILESMolProps</span>
 1472             
 1473 <span class="k">def</span> <span class="nf">ProcessOptionSeabornPlotParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1474     <span class="sd">&quot;&quot;&quot;Process parameters for generating Seaborn plots and return a map containing</span>
 1475 <span class="sd">    processed parameter names and values.</span>
 1476 <span class="sd">    </span>
 1477 <span class="sd">    Arguments:</span>
 1478 <span class="sd">        ParamsOptionName (str): Command line seaborn parameters option name.</span>
 1479 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and value pairs.</span>
 1480 <span class="sd">        ParamsDefaultValues (dict): Default values for selected parameters.</span>
 1481 
 1482 <span class="sd">    Returns:</span>
 1483 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1484 
 1485 <span class="sd">    Notes:</span>
 1486 <span class="sd">        The parameter name and values specified in ParamsOptionValue are validated before</span>
 1487 <span class="sd">        returning them in a dictionary.</span>
 1488 
 1489 <span class="sd">    &quot;&quot;&quot;</span>
 1490     <span class="c1"># The default width and height in Matplotlib is 6.4 and  4.8 and maps to aspect ratio of 1.3...</span>
 1491     <span class="n">ParamsInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Type&#39;</span> <span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;OutExt&#39;</span><span class="p">:</span> <span class="s1">&#39;svg&#39;</span><span class="p">,</span> <span class="s1">&#39;Width&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;Height&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
 1492                   <span class="s1">&#39;Title&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;XLabel&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;YLabel&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;TitleWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;LabelWeight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
 1493                   <span class="s1">&#39;Style&#39;</span><span class="p">:</span> <span class="s1">&#39;darkgrid&#39;</span><span class="p">,</span> <span class="s1">&#39;Palette&#39;</span><span class="p">:</span> <span class="s1">&#39;deep&#39;</span><span class="p">,</span> <span class="s1">&#39;Font&#39;</span><span class="p">:</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">,</span> <span class="s1">&#39;FontScale&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 1494                   <span class="s1">&#39;Context&#39;</span><span class="p">:</span> <span class="s1">&#39;notebook&#39;</span><span class="p">}</span>
 1495 
 1496     <span class="c1"># Setup a canonical paramater names...</span>
 1497     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 1498     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1499     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">):</span>
 1500         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 1501         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 1502     
 1503     <span class="c1"># Update default values...</span>
 1504     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1505         <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1506             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
 1507                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The default parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> to function ProcessOptionSeabornPlotParameters is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamName</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1508             <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1509             
 1510     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1511         <span class="c1"># No specific parameters to process except for parameters with possible auto value...</span>
 1512         <span class="n">_ProcessOptionSeabornPlotParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
 1513         <span class="k">return</span> <span class="n">ParamsInfo</span>
 1514     
 1515     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1516     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
 1517         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
 1518     
 1519     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1520     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1521         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1522     
 1523     <span class="c1"># Validate paramater name and value pairs...</span>
 1524     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1525         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1526         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1527 
 1528         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1529         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 1530             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1531 
 1532         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 1533         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1534         
 1535         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Style$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1536             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(darkgrid|whitegrid|dark|white|ticks)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">):</span>
 1537                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: darkgrid, whitegrid, dark, white or ticks&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1538         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Palette$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1539             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(deep|muted|pastel|dark|bright|colorblind)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">):</span>
 1540                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: deep, muted, pastel, dark, bright or colorblind&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1541         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Context$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1542             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(notebook|paper|talk|poster)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">):</span>
 1543                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: notebook, paper, talk or poster&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1544         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Width|Height)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1545             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1546                 <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1547                 <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1548                     <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1549                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1550         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(FontScale)$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1551             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1552             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1553                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1554             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1555         <span class="c1"># Set value...</span>
 1556         <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1557     
 1558     <span class="c1"># Handle paramaters with possible auto values...</span>
 1559     <span class="n">_ProcessOptionSeabornPlotParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
 1560     
 1561     <span class="k">return</span> <span class="n">ParamsInfo</span>
 1562 
 1563 <span class="k">def</span> <span class="nf">_ProcessOptionSeabornPlotParameters</span><span class="p">(</span><span class="n">ParamsInfo</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1564     <span class="sd">&quot;&quot;&quot;Process parameters with possible auto values.&quot;&quot;&quot;</span>
 1565 
 1566     <span class="k">if</span> <span class="n">ParamsDefaultInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1567         <span class="k">return</span>
 1568 
 1569     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsInfo</span><span class="p">:</span>
 1570         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1571         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1572             <span class="k">if</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1573                 <span class="n">ParamsInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1574     
 1575 <span class="k">def</span> <span class="nf">ProcessOptionNameValuePairParameters</span><span class="p">(</span><span class="n">ParamsOptionName</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">ParamsDefaultInfo</span><span class="p">):</span>
 1576     <span class="sd">&quot;&quot;&quot;Process name and value parameter pairs for an option and return a map</span>
 1577 <span class="sd">    containing processed parameter names and values.</span>
 1578 <span class="sd">    </span>
 1579 <span class="sd">    Arguments:</span>
 1580 <span class="sd">        ParamsOptionName (str): Command line option name for name and value</span>
 1581 <span class="sd">            parameter pairs.</span>
 1582 <span class="sd">        ParamsOptionValue (str): Comma delimited list of parameter name and</span>
 1583 <span class="sd">            value parameter pairs.</span>
 1584 <span class="sd">        ParamsDefaultInfo (dict): A dictionary containing a list of parameter</span>
 1585 <span class="sd">            type and default value pairs keyed by parameter name. Supported</span>
 1586 <span class="sd">            parameter types: bool, int, float, file, and str.</span>
 1587 
 1588 <span class="sd">    Returns:</span>
 1589 <span class="sd">        dictionary: Processed parameter name and value pairs.</span>
 1590 
 1591 <span class="sd">    Notes:</span>
 1592 <span class="sd">        The parameter names and values specified in ParamsOptionValue are validated before</span>
 1593 <span class="sd">        returning them in a dictionary.</span>
 1594 
 1595 <span class="sd">    Examples:</span>
 1596 
 1597 <span class="sd">        ParamsDefaultInfo = {&quot;Cleanup&quot;: [&quot;bool&quot;, True], &quot;RemoveFragments&quot;:</span>
 1598 <span class="sd">            [&quot;bool&quot;, True], &quot;Neutralize&quot;: [&quot;bool&quot;, True],</span>
 1599 <span class="sd">            &quot;CanonicalizeTautomer&quot;: [&quot;bool&quot;, True]}</span>
 1600 <span class="sd">        ProcessOptionNameValuePairParameters(&quot;--methodologyParams&quot;,</span>
 1601 <span class="sd">            Options[&quot;--methodologyParams&quot;], ParamsDefaultInfo)</span>
 1602 
 1603 <span class="sd">    &quot;&quot;&quot;</span>
 1604 
 1605     <span class="c1"># Process parameters default informaton....</span>
 1606     <span class="n">ParamsValueInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1607     <span class="n">ParamsTypeInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1608     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="n">ParamsDefaultInfo</span><span class="p">:</span>
 1609         <span class="p">(</span><span class="n">ParamType</span><span class="p">,</span> <span class="n">ParamValue</span><span class="p">)</span> <span class="o">=</span> <span class="n">ParamsDefaultInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1610         <span class="n">ParamsTypeInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamType</span>
 1611         <span class="n">ParamsValueInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1612     
 1613     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ParamsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1614         <span class="k">return</span> <span class="n">ParamsValueInfo</span>
 1615     
 1616     <span class="c1"># Setup a canonical paramater names...</span>
 1617     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 1618     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1619     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ParamsValueInfo</span><span class="p">):</span>
 1620         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 1621         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 1622     
 1623     <span class="n">ParamsOptionValue</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1624     <span class="k">if</span> <span class="ow">not</span> <span class="n">ParamsOptionValue</span><span class="p">:</span>
 1625         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">ParamsOptionName</span><span class="p">)</span>
 1626     
 1627     <span class="n">ParamsOptionValueWords</span> <span class="o">=</span> <span class="n">ParamsOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1628     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1629         <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1630     
 1631     <span class="c1"># Validate paramater name and value pairs...</span>
 1632     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ParamsOptionValueWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1633         <span class="n">Name</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1634         <span class="n">Value</span> <span class="o">=</span> <span class="n">ParamsOptionValueWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1635 
 1636         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1637         <span class="k">if</span>  <span class="n">CanonicalName</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 1638             <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 1639 
 1640         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 1641         <span class="n">ParamType</span> <span class="o">=</span> <span class="n">ParamsTypeInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span>
 1642         <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1643         
 1644         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(bool|boolean)$&quot;</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1645             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(yes|true)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1646                 <span class="n">Value</span> <span class="o">=</span> <span class="bp">True</span>
 1647             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(no|false)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1648                 <span class="n">Value</span> <span class="o">=</span> <span class="bp">False</span>
 1649             <span class="k">else</span><span class="p">:</span>
 1650                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid value. Supported values: yes, no, true, or false&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1651             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1652         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(int|integer)$&quot;</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1653             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsInteger</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1654                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be an integer.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1655             <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1656         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^float$&quot;</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1657             <span class="k">if</span> <span class="ow">not</span> <span class="n">IsFloat</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1658                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a float.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1659             <span class="n">ParamValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 1660         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^file$&quot;</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1661             <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 1662                 <span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option doen&#39;t exist.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1663             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1664         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(str|string)$&quot;</span><span class="p">,</span> <span class="n">ParamType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1665             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1666         <span class="k">else</span><span class="p">:</span>
 1667             <span class="c1"># Default to string values...</span>
 1668             <span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The parameter type, </span><span class="si">%s</span><span class="s2">, specified for parameter name, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not supported by function ProcessOptionNameValuePairParameters. It&#39;s being treated as a string type...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ParamType</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">ParamsOptionName</span><span class="p">))</span>
 1669             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 1670         
 1671         <span class="c1"># Set value...</span>
 1672         <span class="n">ParamsValueInfo</span><span class="p">[</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 1673     
 1674     <span class="k">return</span> <span class="n">ParamsValueInfo</span>
 1675 
 1676 <span class="k">def</span> <span class="nf">ReplaceHTMLEntitiesInText</span><span class="p">(</span><span class="n">Text</span><span class="p">):</span>
 1677     <span class="sd">&quot;&quot;&quot;Check and replace the followng HTML entities to their respective code</span>
 1678 <span class="sd">    for display in a browser: &lt; (less than), &gt; (greater than), &amp; (ampersand),</span>
 1679 <span class="sd">    &quot; (double quote),  and &#39; (single quote).</span>
 1680 
 1681 <span class="sd">    Arguments:</span>
 1682 <span class="sd">        Text (str): Text value.</span>
 1683 
 1684 <span class="sd">    Returns:</span>
 1685 <span class="sd">        str : Modifed text value.</span>
 1686 
 1687 <span class="sd">    &quot;&quot;&quot;</span>
 1688 
 1689     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;(&lt;|&gt;|&amp;|&quot;|&#39;)&quot;&quot;&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">):</span>
 1690         <span class="k">return</span> <span class="n">Text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;lt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;gt;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="s2">&quot;&amp;amp;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&amp;quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;apos;&quot;</span><span class="p">)</span>
 1691     <span class="k">else</span><span class="p">:</span>
 1692         <span class="k">return</span> <span class="n">Text</span>
 1693 
 1694 <span class="k">def</span> <span class="nf">TruncateText</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">Width</span><span class="p">,</span> <span class="n">TrailingChars</span> <span class="o">=</span> <span class="s2">&quot;...&quot;</span><span class="p">):</span>
 1695     <span class="sd">&quot;&quot;&quot;Truncate text using specified width along with appending any trailing</span>
 1696 <span class="sd">    characters.</span>
 1697 <span class="sd">    </span>
 1698 <span class="sd">    Arguments:</span>
 1699 <span class="sd">        Text (string): Input text.</span>
 1700 <span class="sd">        Width (int): Max number of characters before truncating text.</span>
 1701 <span class="sd">        Delimiter (string): Trailing characters to append or None.</span>
 1702 
 1703 <span class="sd">    Returns:</span>
 1704 <span class="sd">        str : Truncated text</span>
 1705 
 1706 <span class="sd">    &quot;&quot;&quot;</span>
 1707     
 1708     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Text</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Width</span><span class="p">:</span>
 1709         <span class="k">return</span> <span class="n">Text</span>
 1710     
 1711     <span class="n">TruncatedText</span> <span class="o">=</span> <span class="p">(</span><span class="n">Text</span><span class="p">[:</span><span class="n">Width</span><span class="p">]</span> <span class="o">+</span> <span class="n">TrailingChars</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">IsEmpty</span><span class="p">(</span><span class="n">TrailingChars</span><span class="p">)</span> <span class="k">else</span> <span class="n">Text</span><span class="p">[:</span><span class="n">Width</span><span class="p">]</span> 
 1712     
 1713     <span class="k">return</span> <span class="n">TruncatedText</span>
 1714 
 1715 <span class="k">def</span> <span class="nf">WrapText</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">Width</span><span class="p">):</span>
 1716     <span class="sd">&quot;&quot;&quot;Wrap text using specified delimiter and width.</span>
 1717 <span class="sd">    </span>
 1718 <span class="sd">    Arguments:</span>
 1719 <span class="sd">        Text (string): Input text</span>
 1720 <span class="sd">        Delimiter (string): Delimiter for wrapping text</span>
 1721 <span class="sd">        Width (int): Max number of characters before wrapping text</span>
 1722 
 1723 <span class="sd">    Returns:</span>
 1724 <span class="sd">        str : Wrapped text</span>
 1725 
 1726 <span class="sd">    &quot;&quot;&quot;</span>
 1727     <span class="n">WrappedText</span> <span class="o">=</span> <span class="n">Delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">wrap</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">Width</span><span class="p">))</span>
 1728     
 1729     <span class="k">return</span> <span class="n">WrappedText</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
